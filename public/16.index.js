(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1019:function(e,t,n){"use strict";var a=u(n(1)),o=u(n(812)),l=u(n(0)),i=u(n(1021)),r=u(n(201)),s=u(n(200));function u(e){return e&&e.__esModule?e:{default:e}}var d=(0,o.default)({displayName:"UserSelector",propTypes:{label:l.default.string},getInitialState:function(){var e=this;return r.default.get(s.default.getUrl("users/search?value=")).withCredentials().end(function(t,n){t?console.log(t):e.setState({options:n.body.map(function(e){return{value:e.id,label:e.name}})})}),{multiValue:this.props.users,options:[]}},handleOnChange:function(e){this.props.onUsersUpdated(e),this.setState({multiValue:e})},isValidNewOption:function(e){return 0==this.state.options.filter(function(t){return e.toLowerCase()===t.label.toLowerCase()}).length},render:function(){return a.default.createElement("div",{style:{position:"relative",width:"100%"}},a.default.createElement("div",{style:{width:"100%"}},a.default.createElement(i.default,{isMulti:!0,options:this.state.options,onChange:this.handleOnChange,isValidNewOption:this.isValidNewOption,value:this.state.multiValue})))}});e.exports=d},1022:function(e,t,n){"use strict";var a=r(n(1)),o=r(n(812)),l=r(n(0)),i=n(282);function r(e){return e&&e.__esModule?e:{default:e}}var s=(0,o.default)({displayName:"ProblemSection",propTypes:{label:l.default.string},getInitialState:function(){return{sections:this.props.sections,grades:this.props.grades}},onNumberOfSectionsChange:function(e){var t=null;if(e>1){for(t=this.state.sections?this.state.sections:[];e>t.length;)t.push({id:-1*t.length,nr:t.length+1,grade:"n/a",description:null});for(;e<t.length;)t.pop()}this.props.onSectionsUpdated(t),this.setState({sections:t})},onNrChanged:function(e,t){var n=this.state.sections;n.find(function(t){return t.id===e}).nr=t.target.value,this.props.onSectionsUpdated(n),this.setState({sections:n})},onGradeChanged:function(e,t){var n=this.state.sections;n.find(function(t){return t.id===e}).grade=t,this.props.onSectionsUpdated(n),this.setState({sections:n})},onDescriptionChanged:function(e,t){var n=this.state.sections;n.find(function(t){return t.id===e}).description=t.target.value,this.props.onSectionsUpdated(n),this.setState({sections:n})},render:function(){var e=this,t=this.state.sections&&this.state.sections.length>1&&this.state.sections.map(function(t,n){return a.default.createElement(i.Form,{componentClass:"fieldset",inline:!0,key:n},a.default.createElement(i.FormGroup,{controlId:"formNr"},a.default.createElement(i.FormControl,{type:"number",value:t.nr,onChange:e.onNrChanged.bind(e,t.id),style:{width:"50px"}}))," ",a.default.createElement(i.FormGroup,{controlId:"formGrade"},a.default.createElement(i.DropdownButton,{title:t.grade,id:"bg-nested-dropdown"},e.state.grades.map(function(n,o){return a.default.createElement(i.MenuItem,{key:o,eventKey:o,onSelect:e.onGradeChanged.bind(e,t.id,n.grade)},n.grade)})))," ",a.default.createElement(i.FormGroup,{controlId:"formDescription"},a.default.createElement(i.FormControl,{type:"text",value:t.description?t.description:"",onChange:e.onDescriptionChanged.bind(e,t.id),style:{width:"500px"}})))});return a.default.createElement(i.Well,null,a.default.createElement(i.FormGroup,{controlId:"formControlsNumSections"},a.default.createElement(i.DropdownButton,{title:this.state.sections?this.state.sections.length:1,id:"bg-nested-dropdown"},a.default.createElement(i.MenuItem,{key:1,eventKey:1,onSelect:this.onNumberOfSectionsChange.bind(this,1)},"1"),a.default.createElement(i.MenuItem,{key:2,eventKey:2,onSelect:this.onNumberOfSectionsChange.bind(this,2)},"2"),a.default.createElement(i.MenuItem,{key:3,eventKey:3,onSelect:this.onNumberOfSectionsChange.bind(this,3)},"3"),a.default.createElement(i.MenuItem,{key:4,eventKey:4,onSelect:this.onNumberOfSectionsChange.bind(this,4)},"4"),a.default.createElement(i.MenuItem,{key:5,eventKey:5,onSelect:this.onNumberOfSectionsChange.bind(this,5)},"5"),a.default.createElement(i.MenuItem,{key:6,eventKey:6,onSelect:this.onNumberOfSectionsChange.bind(this,6)},"6"),a.default.createElement(i.MenuItem,{key:7,eventKey:7,onSelect:this.onNumberOfSectionsChange.bind(this,7)},"7"),a.default.createElement(i.MenuItem,{key:8,eventKey:8,onSelect:this.onNumberOfSectionsChange.bind(this,8)},"8"),a.default.createElement(i.MenuItem,{key:9,eventKey:9,onSelect:this.onNumberOfSectionsChange.bind(this,9)},"9"),a.default.createElement(i.MenuItem,{key:10,eventKey:10,onSelect:this.onNumberOfSectionsChange.bind(this,10)},"10"),a.default.createElement(i.MenuItem,{key:11,eventKey:11,onSelect:this.onNumberOfSectionsChange.bind(this,11)},"11"),a.default.createElement(i.MenuItem,{key:12,eventKey:12,onSelect:this.onNumberOfSectionsChange.bind(this,12)},"12"),a.default.createElement(i.MenuItem,{key:13,eventKey:13,onSelect:this.onNumberOfSectionsChange.bind(this,13)},"13"),a.default.createElement(i.MenuItem,{key:14,eventKey:14,onSelect:this.onNumberOfSectionsChange.bind(this,14)},"14"),a.default.createElement(i.MenuItem,{key:15,eventKey:15,onSelect:this.onNumberOfSectionsChange.bind(this,15)},"15"),a.default.createElement(i.MenuItem,{key:16,eventKey:16,onSelect:this.onNumberOfSectionsChange.bind(this,16)},"16"),a.default.createElement(i.MenuItem,{key:17,eventKey:17,onSelect:this.onNumberOfSectionsChange.bind(this,17)},"17"),a.default.createElement(i.MenuItem,{key:18,eventKey:18,onSelect:this.onNumberOfSectionsChange.bind(this,18)},"18"),a.default.createElement(i.MenuItem,{key:19,eventKey:19,onSelect:this.onNumberOfSectionsChange.bind(this,19)},"19"),a.default.createElement(i.MenuItem,{key:20,eventKey:20,onSelect:this.onNumberOfSectionsChange.bind(this,20)},"20"))),t)}});e.exports=s},670:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),l=y(o),i=(n(141),n(284)),r=y(n(201)),s=n(282),u=n(696),d=y(n(1019)),c=y(n(1022)),h=y(n(699)),f=y(n(200)),m=y(n(283)),p=y(n(727)),g=n(142);function y(e){return e&&e.__esModule?e:{default:e}}var b=(0,u.withGoogleMap)(function(e){return l.default.createElement(u.GoogleMap,{defaultZoom:e.defaultZoom,defaultCenter:e.defaultCenter,defaultMapTypeId:google.maps.MapTypeId.TERRAIN,onClick:e.onClick.bind(void 0)},e.markers)}),v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"componentDidMount",value:function(){var e=this;r.default.get(f.default.getUrl("grades?regionId="+f.default.getRegion())).end(function(t,n){e.setState({error:t||null,grades:t?null:n.body})}),r.default.get(f.default.getUrl("types?regionId="+f.default.getRegion())).end(function(t,n){e.setState({error:t||null,types:t?null:n.body})}),-1==this.props.match.params.problemId?this.setState({id:-1,visibility:0,name:"",comment:"",originalGrade:"n/a",fa:[],faDate:f.default.convertFromDateToString(new Date),nr:this.props.location.query.nr,lat:0,lng:0,newMedia:[]}):r.default.get(f.default.getUrl("problems?regionId="+f.default.getRegion()+"&id="+this.props.match.params.problemId)).withCredentials().end(function(t,n){t?e.setState({error:t}):e.setState({id:n.body[0].id,visibility:n.body[0].visibility,name:n.body[0].name,comment:n.body[0].comment,originalGrade:n.body[0].originalGrade,fa:n.body[0].fa,faDate:n.body[0].faDate,nr:n.body[0].nr,typeId:n.body[0].t.id,lat:n.body[0].lat,lng:n.body[0].lng,sections:n.body[0].sections,newMedia:[]})})}},{key:"onNameChanged",value:function(e){this.setState({name:e.target.value})}},{key:"onNrChanged",value:function(e){this.setState({nr:parseInt(e.target.value)})}},{key:"onLatChanged",value:function(e){this.setState({lat:parseFloat(e.target.value)})}},{key:"onLngChanged",value:function(e){this.setState({lng:parseFloat(e.target.value)})}},{key:"onVisibilityChanged",value:function(e,t){this.setState({visibility:e})}},{key:"onCommentChanged",value:function(e){this.setState({comment:e.target.value})}},{key:"onFaDateChanged",value:function(e){this.setState({faDate:e})}},{key:"onOriginalGradeChanged",value:function(e,t){this.setState({originalGrade:e})}},{key:"onTypeIdChanged",value:function(e,t){this.setState({typeId:e})}},{key:"onNewMediaChanged",value:function(e){this.setState({newMedia:e})}},{key:"save",value:function(e){var t=this;e.preventDefault(),this.setState({isSaving:!0});var n=this.state.newMedia.map(function(e){return{name:e.file.name.replace(/[^-a-z0-9.]/gi,"_"),photographer:e.photographer,inPhoto:e.inPhoto}}),a=r.default.post(f.default.getUrl("problems?regionId="+f.default.getRegion())).withCredentials().field("json",JSON.stringify({sectorId:this.props.location.query.idSector,id:this.state.id,visibility:this.state.visibility,name:this.state.name,comment:this.state.comment,originalGrade:this.state.originalGrade,fa:this.state.fa,faDate:this.state.faDate,nr:this.state.nr,t:this.state.typeId?this.state.types.find(function(e){return e.id===t.state.typeId}):this.state.types[0],lat:this.state.lat,lng:this.state.lng,sections:this.state.sections,newMedia:n})).set("Accept","application/json");this.state.newMedia.forEach(function(e){return a.attach(e.file.name.replace(/[^-a-z0-9.]/gi,"_"),e.file)}),a.end(function(e,n){e?t.setState({error:e}):t.setState({pushUrl:"/problem/"+n.body.id})})}},{key:"onMapClick",value:function(e){this.setState({lat:e.latLng.lat(),lng:e.latLng.lng()})}},{key:"onUsersUpdated",value:function(e){var t=e.map(function(e){return{id:"string"==typeof e.value||e.value instanceof String?-1:e.value,firstname:e.label,surname:null}});this.setState({fa:t})}},{key:"onSectionsUpdated",value:function(e){this.setState({sections:e})}},{key:"onCancel",value:function(){window.history.back()}},{key:"render",value:function(){var e=this;if(!(this.state&&this.state.id&&this.state.types&&this.state.grades))return l.default.createElement("center",null,l.default.createElement(g.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));if(this.state.error)return l.default.createElement("span",null,l.default.createElement("h3",null,this.state.error.status),this.state.error.toString());if(this.state.pushUrl)return l.default.createElement(i.Redirect,{to:this.state.pushUrl,push:!0});if(!(this.props&&this.props.match&&this.props.match.params&&this.props.match.params.problemId&&this.props.location&&this.props.location.query&&this.props.location.query.idSector))return l.default.createElement("span",null,l.default.createElement("h3",null,"Invalid action..."));var t=new Date;t.setDate(t.getDate()-1);var n="Visible for everyone";1===this.state.visibility?n="Only visible for administrators":2===this.state.visibility&&(n="Only visible for super administrators");var a,o,r=this.state.typeId?this.state.types.find(function(t){return t.id===e.state.typeId}):this.state.types[0];0!=this.state.lat&&0!=this.state.lng?(a={lat:this.state.lat,lng:this.state.lng},o=15):this.props.location.query.lat&&parseFloat(this.props.location.query.lat)>0?(a={lat:parseFloat(this.props.location.query.lat),lng:parseFloat(this.props.location.query.lng)},o=14):(a=f.default.getDefaultCenter(),o=f.default.getDefaultZoom());var y=null;return f.default.isBouldering()||(y=l.default.createElement(s.FormGroup,{controlId:"formControlsSections"},l.default.createElement(s.ControlLabel,null,"Section(s)"),l.default.createElement("br",null),l.default.createElement(c.default,{sections:this.state.sections,grades:this.state.grades,onSectionsUpdated:this.onSectionsUpdated.bind(this)}))),l.default.createElement("span",null,l.default.createElement(s.Well,null,l.default.createElement("form",{onSubmit:this.save.bind(this)},l.default.createElement(s.FormGroup,{controlId:"formControlsName"},l.default.createElement(s.ControlLabel,null,"Problem name"),l.default.createElement(s.FormControl,{type:"text",value:this.state.name,placeholder:"Enter name",onChange:this.onNameChanged.bind(this)})),l.default.createElement(s.FormGroup,{controlId:"formControlsFaDate"},l.default.createElement(s.ControlLabel,null,"FA date (yyyy-mm-dd)"),l.default.createElement("br",null),l.default.createElement(p.default,{format:"YYYY-MM-DD",computableFormat:"YYYY-MM-DD",date:this.state.faDate,onChange:this.onFaDateChanged.bind(this)}),l.default.createElement(s.ButtonGroup,null,l.default.createElement(s.Button,{onClick:this.onFaDateChanged.bind(this,f.default.convertFromDateToString(t))},"Yesterday"),l.default.createElement(s.Button,{onClick:this.onFaDateChanged.bind(this,f.default.convertFromDateToString(new Date))},"Today"))),l.default.createElement(s.FormGroup,{controlId:"formControlsTypeId"},l.default.createElement(s.ControlLabel,null,"Type"),l.default.createElement("br",null),l.default.createElement(s.DropdownButton,{title:r.type+(r.subType?" - "+r.subType:""),id:"bg-nested-dropdown"},this.state.types.map(function(t,n){return l.default.createElement(s.MenuItem,{key:n,eventKey:n,onSelect:e.onTypeIdChanged.bind(e,t.id)},t.type," ",t.subType?" - "+t.subType:"")}))),l.default.createElement(s.FormGroup,{controlId:"formControlsGrade"},l.default.createElement(s.ControlLabel,null,"Grade"),l.default.createElement("br",null),l.default.createElement(s.DropdownButton,{title:this.state.originalGrade,id:"bg-nested-dropdown"},this.state.grades.map(function(t,n){return l.default.createElement(s.MenuItem,{key:n,eventKey:n,onSelect:e.onOriginalGradeChanged.bind(e,t.grade)},t.grade)}))),l.default.createElement(s.FormGroup,{controlId:"formControlsFA"},l.default.createElement(s.ControlLabel,null,"FA"),l.default.createElement("br",null),l.default.createElement(d.default,{users:this.state.fa?this.state.fa.map(function(e){return{value:e.id,label:e.firstname+" "+e.surname}}):[],onUsersUpdated:this.onUsersUpdated.bind(this)})),l.default.createElement(s.FormGroup,{controlId:"formControlsVisibility"},l.default.createElement(s.ControlLabel,null,"Visibility"),l.default.createElement("br",null),l.default.createElement(s.DropdownButton,{title:n,id:"bg-nested-dropdown"},l.default.createElement(s.MenuItem,{eventKey:"0",onSelect:this.onVisibilityChanged.bind(this,0)},"Visible for everyone"),l.default.createElement(s.MenuItem,{eventKey:"1",onSelect:this.onVisibilityChanged.bind(this,1)},"Only visible for administrators"),m.default.isSuperAdmin()&&l.default.createElement(s.MenuItem,{eventKey:"2",onSelect:this.onVisibilityChanged.bind(this,2)},"Only visible for super administrators"))),l.default.createElement(s.FormGroup,{controlId:"formControlsSectorNr"},l.default.createElement(s.ControlLabel,null,"Sector number"),l.default.createElement(s.FormControl,{type:"text",value:this.state.nr,placeholder:"Enter sector number",onChange:this.onNrChanged.bind(this)})),l.default.createElement(s.FormGroup,{controlId:"formControlsComment"},l.default.createElement(s.ControlLabel,null,"Comment"),l.default.createElement(s.FormControl,{style:{height:"100px"},componentClass:"textarea",placeholder:"Enter comment",value:this.state.comment,onChange:this.onCommentChanged.bind(this)})),y,l.default.createElement(s.FormGroup,{controlId:"formControlsMedia"},l.default.createElement(h.default,{onMediaChanged:this.onNewMediaChanged.bind(this)})),l.default.createElement(s.FormGroup,{controlId:"formControlsMap"},l.default.createElement(s.ControlLabel,null,"Click to mark problem on map"),l.default.createElement("br",null),l.default.createElement("section",{style:{height:"600px"}},l.default.createElement(b,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCpaVd5518yMB-oiIyP5JnTVWMfrOv4sAI&v=3.exp",containerElement:l.default.createElement("div",{style:{height:"100%"}}),mapElement:l.default.createElement("div",{style:{height:"100%"}}),defaultZoom:o,defaultCenter:a,onClick:this.onMapClick.bind(this),markers:0!=this.state.lat&&0!=this.state.lng?l.default.createElement(u.Marker,{position:{lat:this.state.lat,lng:this.state.lng}}):""})),l.default.createElement(s.ControlLabel,null,"Latitude"),l.default.createElement(s.FormControl,{type:"text",value:this.state.lat,placeholder:"Latitude",onChange:this.onLatChanged.bind(this)}),l.default.createElement(s.ControlLabel,null,"Longitude"),l.default.createElement(s.FormControl,{type:"text",value:this.state.lng,placeholder:"Longitude",onChange:this.onLngChanged.bind(this)})),l.default.createElement(s.ButtonGroup,null,l.default.createElement(s.Button,{bsStyle:"danger",onClick:this.onCancel.bind(this)},"Cancel"),l.default.createElement(s.Button,{type:"submit",bsStyle:"success",disabled:this.state.isSaving},this.state.isSaving?"Saving...":"Save problem")))))}}]),t}();t.default=v},699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1),l=d(o),i=d(n(703)),r=d(n(201)),s=n(282),u=d(n(200));function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var m=function(e){function t(e){c(this,t);var n=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={searchResults:[],value:""},n}return f(t,o.Component),a(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"inputChange",value:function(e){var t=this,n=e.target.value;this.props.onValueChanged(this.props.m,n),n.length>0?r.default.get(u.default.getUrl("users/search?value="+n)).withCredentials().end(function(e,a){e&&console.log(e);var o=a.body.filter(function(e){return e.name.toUpperCase()!==n.toUpperCase()});t.setState({searchResults:o})}):this.setState({searchResults:[]})}},{key:"menuItemSelect",value:function(e,t){this.setState({searchResults:[]}),this.props.onValueChanged(this.props.m,e.name)}},{key:"render",value:function(){var e=this,t=null;if(this.state.searchResults.length>0){var n=this.state.searchResults.map(function(t,n){return l.default.createElement(s.MenuItem,{key:n,href:"#",onSelect:e.menuItemSelect.bind(e,t)},t.name)});t=l.default.createElement("div",null,l.default.createElement("ul",{className:"dropdown-menu open",style:{position:"absolute",display:"inline"}},n))}return l.default.createElement("div",{style:{position:"relative",width:"100%"}},l.default.createElement("div",{style:{width:"100%"}},l.default.createElement(s.FormControl,{style:{display:"inline-block"},type:"text",placeholder:this.props.placeholder,value:this.state.value,onChange:this.inputChange.bind(this)})),t)}}]),t}(),p=function(e){function t(e){c(this,t);var n=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={media:[]},n}return f(t,o.Component),a(t,[{key:"onDrop",value:function(e){var t=this.state.media;e.forEach(function(e){return t.push({file:e})}),this.setState({media:t}),this.props.onMediaChanged(t)}},{key:"onPhotographerChanged",value:function(e,t){e.photographer=t,this.props.onMediaChanged(this.state.media)}},{key:"onInPhotoChanged",value:function(e,t){e.inPhoto=t,this.props.onMediaChanged(this.state.media)}},{key:"onRemove",value:function(e){var t=this.state.media.filter(function(t){return t!=e});this.setState({media:t}),this.props.onMediaChanged(t)}},{key:"render",value:function(){var e=this;return l.default.createElement(s.FormGroup,null,l.default.createElement(s.ControlLabel,null,"Upload image(s)"),l.default.createElement("br",null),l.default.createElement(i.default,{onDrop:this.onDrop.bind(this),style:{width:"220px",height:"75px",padding:"15px",borderWidth:"1px",borderColor:"#666",borderStyle:"dashed",borderRadius:"5px"},accept:"image/*"},l.default.createElement("i",null,"Drop JPG-image(s) here or click to select files to upload.")),this.state.media.length>0?l.default.createElement(s.Grid,null,l.default.createElement(s.Row,null,this.state.media.map(function(t,n){return l.default.createElement(s.Col,{key:n,xs:8,sm:6,md:4,lg:2},l.default.createElement(s.Thumbnail,{src:t.file.preview},l.default.createElement(m,{m:t,placeholder:"In photo",value:t?t.inPhoto:"",onValueChanged:e.onInPhotoChanged.bind(e)}),l.default.createElement(m,{m:t,placeholder:"Photographer",value:t?t.photographer:"",onValueChanged:e.onPhotographerChanged.bind(e)}),l.default.createElement(s.Button,{style:{width:"100%"},bsStyle:"danger",onClick:e.onRemove.bind(e,t)},"Remove")))}))):null)}}]),t}();t.default=p}}]);
//# sourceMappingURL=16.index.js.map