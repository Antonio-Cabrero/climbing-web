{"version":3,"sources":["webpack:///./app/components/login.js"],"names":["_react","__webpack_require__","s","p","r","o","_reactRouterDom","_reactRouter","i","_reactRouterBootstrap","_reactBootstrap","f","m","e","__esModule","default","Login","props","this","_this","__proto__","Object","getPrototypeOf","call","document","title","config","getTitle","state","message","username","password","Component","email","test","event","_this2","validateEmail","Request","get","getUrl","window","location","hostname","withCredentials","end","err","res","setState","_react2","createElement","Panel","bsStyle","toString","key","value","_this3","preventDefault","auth","login","loggedIn","pushUrl","target","Redirect","to","push","Breadcrumb","Link","color","Well","onSubmit","bind","FormGroup","controlId","ControlLabel","FormControl","type","placeholder","onChange","onUsernameChanged","onPasswordChanged","ButtonGroup","LinkContainer","Button","onClick","forgotPasswordClick","t","contextTypes","router","PropTypes","object"],"mappings":"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","file":"18.index.js","sourcesContent":["import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Link } from 'react-router-dom';\r\nimport { Redirect } from 'react-router';\r\nimport Request from 'superagent';\r\nimport { LinkContainer } from 'react-router-bootstrap';\r\nimport { FormGroup, ControlLabel, FormControl, ButtonGroup, Button, Panel, Breadcrumb, Well } from 'react-bootstrap';\r\nimport auth from '../utils/auth.js'\r\nimport config from '../utils/config.js';\r\n\r\nexport default class Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    document.title=config.getTitle(\"Login\");\r\n    this.state = {\r\n      message: null,\r\n      username: '',\r\n      password: ''\r\n    };\r\n  }\r\n\r\n  validateEmail(email) {\r\n    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    return re.test(email);\r\n  }\r\n\r\n  forgotPasswordClick(event) {\r\n    if (!this.state.username) {\r\n      this.setState({message: <Panel bsStyle='danger'>Please fill username and click Forgot password again.</Panel>});\r\n    } else if (!this.validateEmail(this.state.username)) {\r\n      this.setState({message: <Panel bsStyle='danger'>No email address registered on &quot;{this.state.username}&quot;. Contact Jostein (jostein.oygarden@gmail.com) to recover password.</Panel>});\r\n    } else {\r\n      Request.get(config.getUrl(\"users/forgotPassword?username=\" + this.state.username + \"&hostname=\" + window.location.hostname)).withCredentials().end((err, res) => {\r\n        if (err) {\r\n          this.setState({message: <Panel bsStyle='danger'>{err.toString()}</Panel>});\r\n        } else {\r\n          this.setState({message: <Panel bsStyle='success'>An e-mail with instructions to reset your password is sent to &quot;{this.state.username}&quot;.</Panel>});\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  login(event) {\r\n    event.preventDefault();\r\n    auth.login(this.state.username, this.state.password, (loggedIn) => {\r\n      const { location } = this.props\r\n      if (!loggedIn) {\r\n        return this.setState({message: <Panel bsStyle='danger'>Invalid username and/or password.</Panel>});\r\n      } else {\r\n        return this.setState({message: null, pushUrl: \"/\"});\r\n      }\r\n    });\r\n  }\r\n\r\n  onUsernameChanged(e) {\r\n    this.setState({username: e.target.value});\r\n  }\r\n\r\n  onPasswordChanged(e) {\r\n    this.setState({password: e.target.value});\r\n  }\r\n\r\n  render() {\r\n    if (this.state && this.state.pushUrl) {\r\n      return (<Redirect to={this.state.pushUrl} push />);\r\n    }\r\n    return (\r\n      <span>\r\n        <Breadcrumb>\r\n          <Link to={`/`}>Home</Link> / <font color='#777'>Sign in</font>\r\n        </Breadcrumb>\r\n        <Well>\r\n          {this.state.message}\r\n          <form onSubmit={this.login.bind(this)}>\r\n            <FormGroup controlId=\"formControlsText\">\r\n              <ControlLabel>Username</ControlLabel>\r\n              <FormControl type=\"text\" placeholder=\"Enter username\" onChange={this.onUsernameChanged.bind(this)} />\r\n            </FormGroup>\r\n            <FormGroup controlId=\"formControlsPassword\">\r\n              <ControlLabel>Password</ControlLabel>\r\n              <FormControl type=\"password\" placeholder=\"Enter password\" onChange={this.onPasswordChanged.bind(this)} />\r\n            </FormGroup>\r\n            <ButtonGroup>\r\n              <LinkContainer to={`/register`}><Button bsStyle=\"default\">Register new user</Button></LinkContainer>\r\n              <Button bsStyle=\"default\" onClick={this.forgotPasswordClick.bind(this)}>Forgot password</Button>\r\n              <Button type=\"submit\" bsStyle=\"success\">Login</Button>\r\n            </ButtonGroup>\r\n          </form>\r\n        </Well>\r\n      </span>\r\n    );\r\n  }\r\n}\r\n\r\nLogin.contextTypes = {\r\n  router: PropTypes.object\r\n}\r\n"],"sourceRoot":""}