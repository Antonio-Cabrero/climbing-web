(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{663:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(1),l=g(r),o=g(a(681)),i=a(141),u=g(a(201)),s=a(282),c=a(742),d=a(285),f=g(a(695)),p=g(a(283)),m=g(a(200)),h=a(142);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){e.setState({currLat:t.coords.latitude,currLng:t.coords.longitude})}),u.default.get(m.default.getUrl("areas/list?regionId="+m.default.getRegion())).withCredentials().end(function(t,a){e.setState({error:t||null,areas:t?null:a.body})})}},{key:"formatName",value:function(e,t){return l.default.createElement("span",null,l.default.createElement(i.Link,{to:"/area/"+t.id},t.name)," ",1===t.visibility&&l.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===t.visibility&&l.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"}))}},{key:"toRad",value:function(e){return e*Math.PI/180}},{key:"calcCrow",value:function(e,t,a,n){var r=this.toRad(a-e),l=this.toRad(n-t),o=(e=this.toRad(e),a=this.toRad(a),Math.sin(r/2)*Math.sin(r/2)+Math.sin(l/2)*Math.sin(l/2)*Math.cos(e)*Math.cos(a));return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6371}},{key:"formatDistance",value:function(e,t){return this.state.currLat>0&&this.state.currLng>0&&t.lat>0&&t.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,t.lat,t.lng).toFixed(1)+" km":""}},{key:"sortDistance",value:function(e,t,a){var n=this.state.currLat>0&&this.state.currLng>0&&e.lat>0&&e.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,e.lat,e.lng):0,r=this.state.currLat>0&&this.state.currLng>0&&t.lat>0&&t.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,t.lat,t.lng):0;return"asc"===a?n<r?-1:n>r?1:0:n<r?1:n>r?-1:0}},{key:"render",value:function(){if(!this.state||!this.state.areas)return l.default.createElement("center",null,l.default.createElement(h.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));if(this.state.error)return l.default.createElement("span",null,l.default.createElement("h3",null,this.state.error.status),this.state.error.toString());var e=this.state.areas.filter(function(e){return 0!=e.lat&&0!=e.lng}).map(function(e){return{lat:e.lat,lng:e.lng,title:e.name,label:e.name.charAt(0),url:"/area/"+e.id}}),t=e.length>0?l.default.createElement(f.default,{markers:e,defaultCenter:m.default.getDefaultCenter(),defaultZoom:m.default.getDefaultZoom()}):null;return l.default.createElement("span",null,l.default.createElement(o.default,null,l.default.createElement("title",null,m.default.getTitle("Browse")),l.default.createElement("meta",{name:"description",content:"Browse areas"})),l.default.createElement(s.Breadcrumb,null,p.default.isAdmin()?l.default.createElement(s.OverlayTrigger,{placement:"top",overlay:l.default.createElement(s.Tooltip,{id:-1},"Add area")},l.default.createElement("div",{style:{float:"right"}},l.default.createElement(d.LinkContainer,{to:"/area/edit/-1"},l.default.createElement(s.Button,{bsStyle:"primary",bsSize:"xsmall"},l.default.createElement(h.FontAwesomeIcon,{icon:"plus-square",inverse:!0}))))):null,l.default.createElement(i.Link,{to:"/"},"Home")," / ",l.default.createElement("font",{color:"#777"},"Browse")),t,l.default.createElement(c.BootstrapTable,{data:this.state.areas,condensed:!0,hover:!0,columnFilter:!1},l.default.createElement(c.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"id"),l.default.createElement(c.TableHeaderColumn,{dataField:"name",dataSort:!0,dataFormat:this.formatName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Name"),l.default.createElement(c.TableHeaderColumn,{dataField:"numSectors",dataSort:!0,dataAlign:"center",width:"50"},"#sectors"),l.default.createElement(c.TableHeaderColumn,{dataField:"numProblems",dataSort:!0,dataAlign:"center",width:"50"},"#problems"),l.default.createElement(c.TableHeaderColumn,{dataField:"distance",dataSort:!0,dataFormat:this.formatDistance.bind(this),sortFunc:this.sortDistance.bind(this),dataAlign:"center",width:"60"},l.default.createElement(h.FontAwesomeIcon,{icon:"plane"}))))}}]),t}();t.default=y},695:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(1),l=s(r),o=a(284),i=a(696),u=s(a(708));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){e.setState({currLat:t.coords.latitude,currLng:t.coords.longitude})})}},{key:"handleOnClick",value:function(e){this.setState({pushUrl:e})}},{key:"render",value:function(){var e=this;if(this.state&&this.state.pushUrl)return l.default.createElement(o.Redirect,{to:this.state.pushUrl,push:!0});var t=null;this.props.markers&&(t=this.props.markers.map(function(t,a){return t.icon.url&&(null.url=t.icon.url),t.icon.scaledSizeW&&t.icon.scaledSizeH&&(null.scaledSize=new google.maps.Size(t.icon.scaledSizeW,t.icon.scaledSizeH)),t.icon.labelOriginX&&t.icon.labelOriginY&&(null.labelOrigin=new google.maps.Point(t.icon.labelOriginX,t.icon.labelOriginY)),l.default.createElement(i.Marker,{icon:null,key:a,position:{lat:t.lat,lng:t.lng},label:t.label,title:t.title,clickable:!0,onClick:e.handleOnClick.bind(e,t.url)})})),this.state&&this.state.currLat&&this.state.currLng&&this.state.currLat>0&&this.state.currLng>0&&t.push(l.default.createElement(i.Marker,{key:-1,icon:"https://maps.gstatic.com/mapfiles/markers2/measle_blue.png",position:{lat:this.state.currLat,lng:this.state.currLng}}));var a=null;this.props.polygons&&(a=this.props.polygons.map(function(t,a){return l.default.createElement(i.Polygon,{key:a,paths:t.triangleCoords,options:{strokeColor:"#FF3300",strokeOpacity:"0.5",strokeWeight:"2",fillColor:"#FF3300",fillOpacity:"0.15"},onClick:e.handleOnClick.bind(e,t.url)})}));var n=(0,i.withScriptjs)((0,i.withGoogleMap)(function(n){return l.default.createElement(i.GoogleMap,{defaultZoom:e.props.defaultZoom,defaultCenter:e.props.defaultCenter,defaultMapTypeId:google.maps.MapTypeId.TERRAIN},l.default.createElement(u.default,{averageCenter:!1,minimumClusterSize:60,enableRetinaIcons:!1,imagePath:"https://raw.githubusercontent.com/googlemaps/js-marker-clusterer/gh-pages/images/m",gridSize:60},t,a))}));return l.default.createElement("section",{style:{height:"600px"}},l.default.createElement(n,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCpaVd5518yMB-oiIyP5JnTVWMfrOv4sAI&v=3.exp",loadingElement:l.default.createElement("div",{style:{height:"100%"}}),containerElement:l.default.createElement("div",{style:{height:"100%"}}),mapElement:l.default.createElement("div",{style:{height:"100%"}})}))}}]),t}();t.default=c}}]);
//# sourceMappingURL=9.index.js.map