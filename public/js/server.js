!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=23)}([function(e,t){e.exports=require("react")},function(e,t){e.exports=require("react-cookie")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("react-bootstrap")},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("@fortawesome/react-fontawesome")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getImageUrl=function(e,t){if(t)return o("/images?id="+e+"&targetHeight="+t);return o("/images?id="+e)},t.convertFromDateToString=i,t.deleteMedia=function(e,t){return(0,n.default)(l("/media?id="+t),{mode:"cors",method:"DELETE",credentials:"include",headers:{Authorization:"Bearer "+e}})},t.getArea=function(e,t){return(0,n.default)(l("/areas?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})},t.getAreaEdit=function(e,t){if(-1!=t)return(0,n.default)(l("/areas?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).then(function(e){return{id:e.id,visibility:e.visibility,name:e.name,comment:e.comment,lat:e.lat,lng:e.lng,newMedia:[],metadata:e.metadata}}).catch(function(e){return console.warn(e),null});s(e).then(function(e){return{id:-1,visibility:0,name:"",comment:"",lat:0,lng:0,newMedia:[],metadata:{title:"New area | "+e.metadata.title,defaultZoom:e.metadata.defaultZoom,defaultCenter:e.metadata.defaultCenter,isAdmin:e.metadata.isAdmin,isSuperAdmin:e.metadata.isSuperAdmin}}}).catch(function(e){return console.warn(e),null})},t.getBrowse=function(e){return(0,n.default)(l("/browse"),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})},t.getFinder=function(e,t){return(0,n.default)(l("/finder?grade="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})},t.getFrontpage=function(e){return(0,n.default)(l("/frontpage"),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})},t.getMeta=s,t.getProblem=function(e,t){return(0,n.default)(l("/problems?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).then(function(e){return e[0]}).catch(function(e){return console.warn(e),null})},t.getProblemEdit=function(e,t){if(-1!=t)return(0,n.default)(l("/problems?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).then(function(e){return e[0]}).then(function(e){return{id:e.id,visibility:e.visibility,name:e.name,comment:e.comment,originalGrade:e.originalGrade,fa:e.fa,faDate:e.faDate,nr:e.nr,typeId:e.t.id,lat:e.lat,lng:e.lng,sections:e.sections,metadata:e.metadata,newMedia:[]}}).catch(function(e){return console.warn(e),null});s(e).then(function(e){return{id:-1,visibility:0,name:"",comment:"",originalGrade:"n/a",fa:[],faDate:i(new Date),nr:0,lat:0,lng:0,newMedia:[],metadata:{title:"New problem | "+e.metadata.title,defaultZoom:e.metadata.defaultZoom,defaultCenter:e.metadata.defaultCenter,grades:e.metadata.grades,types:e.metadata.types,isAdmin:e.metadata.isAdmin,isSuperAdmin:e.metadata.isSuperAdmin}}}).catch(function(e){return console.warn(e),null})},t.getSector=function(e,t){return(0,n.default)(l("/sectors?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})},t.getSectorEdit=function(e,t){if(-1!=t)return(0,n.default)(l("/sectors?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).then(function(e){return{id:e.id,visibility:e.visibility,name:e.name,comment:e.comment,lat:e.lat,lng:e.lng,newMedia:[],metadata:e.metadata}}).catch(function(e){return console.warn(e),null});s(e).then(function(e){return{id:-1,visibility:0,name:"",comment:"",lat:0,lng:0,newMedia:[],metadata:{title:"New sector | "+e.metadata.title,defaultZoom:e.metadata.defaultZoom,defaultCenter:e.metadata.defaultCenter,isAdmin:e.metadata.isAdmin,isSuperAdmin:e.metadata.isSuperAdmin}}}).catch(function(e){return console.warn(e),null})},t.getSvgEdit=function(e,t){var a=t.split("-"),o=a[0],i=a[1];return(0,n.default)(l("/problems?id="+o),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).then(function(e){return e[0]}).then(function(e){var t=e.media.filter(function(e){return e.id==i})[0],a=[],n=0,o=[];if(t.svgs){var l=!0,s=!1,u=void 0;try{for(var c,d=t.svgs[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var f=c.value;f.problemId===e.id?(n=f.id,o=(0,r.parsePath)(f.path)):a.push({nr:f.nr,hasAnchor:f.hasAnchor,path:f.path})}}catch(e){s=!0,u=e}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}}return{mediaId:t.id,nr:e.nr,w:t.width,h:t.height,ctrl:!1,svgId:n,points:o,readOnlySvgs:a,activePoint:0,draggedPoint:!1,draggedCubic:!1,hasAnchor:!0,areaId:e.areaId,areaName:e.areaName,areaVisibility:e.areaVisibility,sectorId:e.sectorId,sectorName:e.sectorName,sectorVisibility:e.sectorVisibility,id:e.id,name:e.name,grade:e.grade,visibility:e.visibility,metadata:e.metadata}}).catch(function(e){return console.warn(e),null})},t.getUser=function(e,t){return(0,n.default)(l("/users?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})},t.getUserEdit=function(e,t){return(0,n.default)(l("/users/edit?id="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).then(function(e){return{id:e.id,username:e.username,firstname:e.firstname,lastname:e.lastname,currentPassword:null,newPassword:null,newPassword2:null,message:null}}).catch(function(e){return console.warn(e),null})},t.getUserSearch=function(e,t){return(0,n.default)(l("/users/search?value="+t),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})},t.postArea=function(e,t,a,r,o,i,s,u){var c=new FormData,d=u.map(function(e){return{name:e.file.name.replace(/[^-a-z0-9.]/gi,"_"),photographer:e.photographer,inPhoto:e.inPhoto}});return c.append("json",JSON.stringify({id:t,visibility:a,name:r,comment:o,lat:i,lng:s,newMedia:d})),u.forEach(function(e){return c.append(e.file.name.replace(/[^-a-z0-9.]/gi,"_"),e.file)}),(0,n.default)(l("/areas"),{mode:"cors",method:"POST",credentials:"include",body:c,headers:{Authorization:"Bearer "+e,Accept:"application/json"}}).then(function(e){return e.json()})},t.postComment=function(e,t,a){return(0,n.default)(l("/comments"),{mode:"cors",method:"POST",credentials:"include",body:JSON.stringify({idProblem:t,comment:a}),headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}})},t.postProblem=function(e,t,a,r,o,i,s,u,c,d,f,m,h,p,b){var y=new FormData,g=b.map(function(e){return{name:e.file.name.replace(/[^-a-z0-9.]/gi,"_"),photographer:e.photographer,inPhoto:e.inPhoto}});return y.append("json",JSON.stringify({sectorId:t,id:a,visibility:r,name:o,comment:i,originalGrade:s,fa:u,faDate:c,nr:d,t:f,lat:m,lng:h,sections:p,newMedia:g})),b.forEach(function(e){return y.append(e.file.name.replace(/[^-a-z0-9.]/gi,"_"),e.file)}),(0,n.default)(l("/problems"),{mode:"cors",method:"POST",credentials:"include",body:y,headers:{Authorization:"Bearer "+e,Accept:"application/json"}}).then(function(e){return e.json()})},t.postProblemMedia=function(e,t,a){var r=new FormData,o=a.map(function(e){return{name:e.file.name.replace(/[^-a-z0-9.]/gi,"_"),photographer:e.photographer,inPhoto:e.inPhoto}});return r.append("json",JSON.stringify({id:t,newMedia:o})),a.forEach(function(e){return r.append(e.file.name.replace(/[^-a-z0-9.]/gi,"_"),e.file)}),(0,n.default)(l("/problems/media"),{mode:"cors",method:"POST",credentials:"include",body:r,headers:{Authorization:"Bearer "+e,Accept:"application/json"}}).then(function(e){return e.json()})},t.postProblemSvg=function(e,t,a,r,o,i,s){return(0,n.default)(l("/problems/svg?problemId="+t+"&mediaId="+a),{mode:"cors",method:"POST",credentials:"include",body:JSON.stringify({delete:r,id:o,path:i,hasAnchor:s}),headers:{Authorization:"Bearer "+e,"Content-Type":"application/json",Accept:"application/json"}})},t.postSearch=function(e,t){return(0,n.default)(l("/search"),{mode:"cors",method:"POST",credentials:"include",body:JSON.stringify({value:t}),headers:{Authorization:"Bearer "+e,"Content-Type":"application/json",Accept:"application/json"}}).then(function(e){return e.json()})},t.postSector=function(e,t,a,r,o,i,s,u,c){var d=new FormData,f=c.map(function(e){return{name:e.file.name.replace(/[^-a-z0-9.]/gi,"_"),photographer:e.photographer,inPhoto:e.inPhoto}});return d.append("json",JSON.stringify({areaId:t,id:a,visibility:r,name:o,comment:i,lat:s,lng:u,newMedia:f})),c.forEach(function(e){return d.append(e.file.name.replace(/[^-a-z0-9.]/gi,"_"),e.file)}),(0,n.default)(l("/sectors"),{mode:"cors",method:"POST",credentials:"include",body:d,headers:{Authorization:"Bearer "+e,Accept:"application/json"}}).then(function(e){return e.json()})},t.postTicks=function(e,t,a,r,o,i,s,u){return(0,n.default)(l("/ticks"),{mode:"cors",method:"POST",credentials:"include",body:JSON.stringify({delete:t,id:a,idProblem:r,comment:o,date:i,stars:s,grade:u}),headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}})},t.postUserEdit=function(e,t,a,r,o,i,s){return(0,n.default)(l("/users/edit"),{mode:"cors",method:"POST",credentials:"include",body:JSON.stringify({id:t,username:a,firstname:r,lastname:o,currentPassword:i,newPassword:s}),headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}})},t.postUserRegister=function(e,t,a,r,o){return(0,n.default)(l("/users/register"),{mode:"cors",method:"POST",credentials:"include",body:JSON.stringify({firstname:t,lastname:a,username:r,password:o}),headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"}})};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(35)),r=a(19);function o(e){var t=global.myOrigin;return"http://localhost:3000"===t&&(t="https://brattelinjer.no"),t+"/com.buldreinfo.jersey.jaxb/v2"+e}function l(e){return encodeURI(o(e))}function i(e){var t=e.getDate(),a=e.getMonth()+1;return e.getFullYear()+"-"+(a<=9?"0"+a:a)+"-"+(t<=9?"0"+t:t)}function s(e){return(0,n.default)(l("/meta"),{credentials:"include",headers:{Authorization:"Bearer "+e}}).then(function(e){return e.json()}).catch(function(e){return console.warn(e),null})}a(36).polyfill()},function(e,t){e.exports=require("react-meta-tags")},function(e,t){e.exports=require("react-router")},function(e,t){e.exports=require("react-router-bootstrap")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=u(r),l=a(8),i=a(11),s=u(a(31));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){e.setState({currLat:t.coords.latitude,currLng:t.coords.longitude})})}},{key:"handleOnClick",value:function(e){this.setState({pushUrl:e})}},{key:"render",value:function(){var e=this;if(this.state&&this.state.pushUrl)return o.default.createElement(l.Redirect,{to:this.state.pushUrl,push:!0});var t=(0,i.withScriptjs)((0,i.withGoogleMap)(function(t){var a=null;e.props.markers&&(a=e.props.markers.map(function(t,a){var n=null;return t.icon&&(n={},t.icon.url&&(n.url=t.icon.url),t.icon.scaledSizeW&&t.icon.scaledSizeH&&(n.scaledSize=new google.maps.Size(t.icon.scaledSizeW,t.icon.scaledSizeH)),t.icon.labelOriginX&&t.icon.labelOriginY&&(n.labelOrigin=new google.maps.Point(t.icon.labelOriginX,t.icon.labelOriginY))),o.default.createElement(i.Marker,{icon:n,key:a,position:{lat:t.lat,lng:t.lng},label:t.label,title:t.title,clickable:!0,onClick:e.handleOnClick.bind(e,t.url)})})),e.state&&e.state.currLat&&e.state.currLng&&e.state.currLat>0&&e.state.currLng>0&&a.push(o.default.createElement(i.Marker,{key:-1,icon:"https://maps.gstatic.com/mapfiles/markers2/measle_blue.png",position:{lat:e.state.currLat,lng:e.state.currLng}}));var n=null;return e.props.polygons&&(n=e.props.polygons.map(function(t,a){return o.default.createElement(i.Polygon,{key:a,paths:t.triangleCoords,options:{strokeColor:"#FF3300",strokeOpacity:"0.5",strokeWeight:"2",fillColor:"#FF3300",fillOpacity:"0.15"},onClick:e.handleOnClick.bind(e,t.url)})})),o.default.createElement(i.GoogleMap,{defaultZoom:e.props.defaultZoom,defaultCenter:e.props.defaultCenter,defaultMapTypeId:google.maps.MapTypeId.TERRAIN},o.default.createElement(s.default,{averageCenter:!1,minimumClusterSize:60,enableRetinaIcons:!1,imagePath:"https://raw.githubusercontent.com/googlemaps/js-marker-clusterer/gh-pages/images/m",gridSize:60},a,n))}));return o.default.createElement("section",{style:{height:"600px"}},o.default.createElement(t,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCpaVd5518yMB-oiIyP5JnTVWMfrOv4sAI&v=3.exp",loadingElement:o.default.createElement("div",{style:{height:"100%"}}),containerElement:o.default.createElement("div",{style:{height:"100%"}}),mapElement:o.default.createElement("div",{style:{height:"100%"}})}))}}]),t}();t.default=c},function(e,t){e.exports=require("react-google-maps")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=c(r),l=(a(2),a(1)),i=c(a(38)),s=a(3),u=a(6);function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){function t(e){d(this,t);var a=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={searchResults:[],value:""},a}return m(t,r.Component),n(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"inputChange",value:function(e){var t=this,a=e.target.value;this.props.onValueChanged(this.props.m,a),a.length>0?(0,u.getUserSearch)(this.props.accessToken,a).then(function(e){var n=e.filter(function(e){return e.name.toUpperCase()!==a.toUpperCase()});t.setState({searchResults:n})}):this.setState({searchResults:[]})}},{key:"menuItemSelect",value:function(e,t){this.setState({searchResults:[]}),this.props.onValueChanged(this.props.m,e.name)}},{key:"render",value:function(){var e=this,t=null;if(this.state.searchResults.length>0){var a=this.state.searchResults.map(function(t,a){return o.default.createElement(s.MenuItem,{key:a,href:"#",onSelect:e.menuItemSelect.bind(e,t)},t.name)});t=o.default.createElement("div",null,o.default.createElement("ul",{className:"dropdown-menu open",style:{position:"absolute",display:"inline"}},a))}return o.default.createElement("div",{style:{position:"relative",width:"100%"}},o.default.createElement("div",{style:{width:"100%"}},o.default.createElement(s.FormControl,{style:{display:"inline-block"},type:"text",placeholder:this.props.placeholder,value:this.state.value,onChange:this.inputChange.bind(this)})),t)}}]),t}(),p=function(e){function t(e){d(this,t);var a=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={media:[]},a}return m(t,r.Component),n(t,[{key:"onDrop",value:function(e){var t=this.state.media;e.forEach(function(e){return t.push({file:e})}),this.setState({media:t}),this.props.onMediaChanged(t)}},{key:"onPhotographerChanged",value:function(e,t){e.photographer=t,this.props.onMediaChanged(this.state.media)}},{key:"onInPhotoChanged",value:function(e,t){e.inPhoto=t,this.props.onMediaChanged(this.state.media)}},{key:"onRemove",value:function(e){var t=this.state.media.filter(function(t){return t!=e});this.setState({media:t}),this.props.onMediaChanged(t)}},{key:"render",value:function(){var e=this,t=this.props.cookies.get("access_token");return o.default.createElement(s.FormGroup,null,o.default.createElement(s.ControlLabel,null,"Upload image(s)"),o.default.createElement("br",null),o.default.createElement(i.default,{onDrop:this.onDrop.bind(this),style:{width:"220px",height:"75px",padding:"15px",borderWidth:"1px",borderColor:"#666",borderStyle:"dashed",borderRadius:"5px"},accept:"image/*"},o.default.createElement("i",null,"Drop JPG-image(s) here or click to select files to upload.")),this.state.media.length>0?o.default.createElement(s.Grid,null,o.default.createElement(s.Row,null,this.state.media.map(function(a,n){return o.default.createElement(s.Col,{key:n,xs:8,sm:6,md:4,lg:2},o.default.createElement(s.Thumbnail,{src:a.file.preview},o.default.createElement(h,{accessToken:t,m:a,placeholder:"In photo",value:a?a.inPhoto:"",onValueChanged:e.onInPhotoChanged.bind(e)}),o.default.createElement(h,{accessToken:t,m:a,placeholder:"Photographer",value:a?a.photographer:"",onValueChanged:e.onPhotographerChanged.bind(e)}),o.default.createElement(s.Button,{style:{width:"100%"},bsStyle:"danger",onClick:e.onRemove.bind(e,a)},"Remove")))}))):null)}}]),t}();t.default=(0,l.withCookies)(p)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=y(r),l=a(2),i=a(1),s=y(a(32)),u=a(3),c=y(a(33)),d=a(18),f=a(4),m=a(8),h=y(a(34)),p=a(5),b=a(6);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={mediaIndex:0,hoverTrash:!1,hoverEdit:!1,showFullscreenButton:!0,showGalleryFullscreenButton:!0,showPlayButton:!0,showGalleryPlayButton:!1,showVideo:{},isFullscreen:!1,pushUrl:null},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({mediaIndex:0,hoverTrash:!1,hoverEdit:!1,showFullscreenButton:!0,showGalleryFullscreenButton:!0,showPlayButton:!0,showGalleryPlayButton:!1,showVideo:{},isFullscreen:!1,pushUrl:null}),this.imageGallery&&this.imageGallery.slideToIndex(0)}},{key:"toggleHoverTrash",value:function(){this.setState({hoverTrash:!this.state.hoverTrash})}},{key:"toggleHoverEdit",value:function(){this.setState({hoverEdit:!this.state.hoverEdit})}},{key:"onDeleteImage",value:function(e){var t=this;if(confirm("Are you sure you want to delete this image?")){var a=this.props.cookies.get("access_token"),n=this.props.media[this.state.mediaIndex].id;(0,b.deleteMedia)(a,n).then(function(e){if(t.props.media.length>1&&t.state.mediaIndex>=t.props.media.length-1){var a=t.state.mediaIndex-1;t.setState({mediaIndex:a}),t.imageGallery.slideToIndex(a)}t.props.removeMedia(n)}).catch(function(e){console.warn(e)})}}},{key:"onSlide",value:function(e){this.resetVideo(),this.setState({mediaIndex:e})}},{key:"onScreenChange",value:function(e){this.setState({isFullscreen:e})}},{key:"resetVideo",value:function(){this.setState({showVideo:{}}),this.state.showPlayButton&&this.setState({showGalleryPlayButton:!0}),this.state.showFullscreenButton&&this.setState({showGalleryFullscreenButton:!0})}},{key:"toggleShowVideo",value:function(e){this.state.showVideo[e]=!Boolean(this.state.showVideo[e]),this.setState({showVideo:this.state.showVideo}),this.state.showVideo[e]&&(this.state.showPlayButton&&this.setState({showGalleryPlayButton:!1}),this.state.showFullscreenButton&&this.setState({showGalleryFullscreenButton:!1}))}},{key:"renderVideo",value:function(e){var t=this;return o.default.createElement("div",{className:"image-gallery-image"},this.state.showVideo[e.embedUrl]?o.default.createElement("span",null,o.default.createElement("a",{className:"gallery-close-video",onClick:this.toggleShowVideo.bind(this,e.embedUrl)}),o.default.createElement(c.default,{ref:function(e){t.player=e},className:"react-player",width:"100%",height:"100%",url:e.embedUrl,onDuration:function(e){return t.setState({duration:e})},onStart:function(){return t.player.seekTo(parseFloat(e.seekTo/t.state.duration))},controls:!0,playing:!0})):o.default.createElement("a",{onClick:this.toggleShowVideo.bind(this,e.embedUrl)},o.default.createElement("div",{className:"gallery-play-button"}),o.default.createElement("img",{src:e.original,alt:this.props.alt})))}},{key:"pushUrl",value:function(e){this.setState({pushUrl:e})}},{key:"generateShapes",value:function(e,t,a,n){var r=this;return e.map(function(e,l){var i,s=(0,d.parseSVG)(e.path);(0,d.makeAbsolute)(s);for(var u,c=0,f=99999999,m=0,h=s.length;m<h;m++)s[m].y>c&&(i=m,c=s[m].y),s[m].y<f&&(u=m,f=s[m].y);var p=s[i].x,b=s[i].y,y=.012*a;p<y&&(p=y),p>a-y&&(p=a-y),b<y&&(b=y),b>n-y&&(b=n-y);var g=null;return e.hasAnchor&&(g=o.default.createElement("circle",{className:"buldreinfo-svg-ring",cx:s[u].x,cy:s[u].y,r:.006*a})),o.default.createElement("g",{className:"buldreinfo-svg-pointer buldreinfo-svg-hover"+(0===t||e.problemId===t?"":" buldreinfo-svg-opacity"),key:l,onClick:r.pushUrl.bind(r,"/problem/"+e.problemId)},o.default.createElement("path",{d:e.path,className:"buldreinfo-svg-route",strokeWidth:.003*a,strokeDasharray:.006*a}),o.default.createElement("circle",{className:"buldreinfo-svg-ring",cx:p,cy:b,r:y}),o.default.createElement("text",{className:"buldreinfo-svg-routenr",x:p,y:b,fontSize:.02*a,dy:".3em"},e.nr),g)})}},{key:"renderImage",value:function(e){return e.svgs?o.default.createElement("div",{className:"image-gallery-image"},o.default.createElement("canvas",{className:"buldreinfo-svg-canvas-ie-hack",width:e.width,height:e.height}),o.default.createElement("svg",{className:"buldreinfo-svg",viewBox:"0 0 "+e.width+" "+e.height,preserveAspectRatio:"xMidYMid meet"},o.default.createElement("image",{xlinkHref:(0,b.getImageUrl)(e.id),width:"100%",height:"100%"}),this.generateShapes(e.svgs,e.svgProblemId,e.width,e.height))):o.default.createElement("div",{className:"image-gallery-image"},o.default.createElement("img",{src:(0,b.getImageUrl)(e.id),className:"buldreinfo-scale-img",alt:this.props.alt}))}},{key:"render",value:function(){var e=this;if((0,h.default)(null,{watchMQ:!0}),this.state&&this.state.pushUrl)return o.default.createElement(m.Redirect,{to:this.state.pushUrl,push:!0});var t=this.props.media.map(function(t,a){return 1==t.idType?{original:(0,b.getImageUrl)(t.id),thumbnail:(0,b.getImageUrl)(t.id),originalClass:"featured-slide",thumbnailClass:"featured-thumb",originalAlt:"original-alt",thumbnailAlt:"thumbnail-alt",renderItem:e.renderImage.bind(e,t)}:{original:(0,b.getImageUrl)(t.id),thumbnail:(0,b.getImageUrl)(t.id),originalClass:"featured-slide",thumbnailClass:"featured-thumb",originalAlt:"original-alt",thumbnailAlt:"thumbnail-alt",embedUrl:"https://buldreinfo.com/buldreinfo_media/mp4/"+100*Math.floor(t.id/100)+"/"+t.id+".mp4",seekTo:t.t,renderItem:e.renderVideo.bind(e)}}),a="",n=this.props.media[this.state.mediaIndex];return!this.state.isFullscreen&&1==n.idType&&this.props.isAdmin&&(n.svgProblemId>0?a=o.default.createElement("span",{style:{position:"absolute",zIndex:"4",background:"rgba(0, 0, 0, 0.4)",padding:"8px 20px"}},o.default.createElement(f.Link,{to:"/problem/svg-edit/"+n.svgProblemId+"-"+n.id,onMouseEnter:this.toggleHoverEdit.bind(this),onMouseLeave:this.toggleHoverEdit.bind(this)},o.default.createElement(p.FontAwesomeIcon,{icon:"edit",style:this.state.hoverEdit?{transform:"scale(1.1)",color:"#fff"}:{color:"#fff"}}))):n.svgs||(a=o.default.createElement("span",{style:{position:"absolute",zIndex:"4",background:"rgba(0, 0, 0, 0.4)",padding:"8px 20px"}},o.default.createElement("a",{href:"#",onMouseEnter:this.toggleHoverTrash.bind(this),onMouseLeave:this.toggleHoverTrash.bind(this)},o.default.createElement(p.FontAwesomeIcon,{icon:"trash",style:this.state.hoverTrash?{transform:"scale(1.1)",color:"#fff"}:{color:"#fff"},onClick:this.onDeleteImage.bind(this)}))))),o.default.createElement(u.Well,{className:"app"},a,o.default.createElement(s.default,{ref:function(t){return e.imageGallery=t},items:t,onSlide:this.onSlide.bind(this),onScreenChange:this.onScreenChange.bind(this),showThumbnails:this.props.showThumbnails,showBullets:this.state.showFullscreenButton&&this.state.showGalleryFullscreenButton&&this.props.media.length>1,showIndex:this.state.showFullscreenButton&&this.state.showGalleryFullscreenButton,showPlayButton:!1,showFullscreenButton:this.state.showFullscreenButton&&this.state.showGalleryFullscreenButton}))}}]),t}();g.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(g)},function(e,t){e.exports=require("react-bootstrap-table")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.login=function(){i.authorize({domain:"buldreinfo.auth0.com",clientID:"zexpFfou6HkgNWH5QVi3zyT1rrw6MXAn",redirectUri:window.location.origin+"/callback",audience:"https://buldreinfo.auth0.com/userinfo",responseType:"token id_token",scope:"openid"})},t.logout=function(e){(function(e){e.remove(o)})(e),function(e){e.remove(l)}(e)},t.getIdToken=s,t.getAccessToken=function(e){return e.get(l)},t.setAccessToken=function(e){var t=u("access_token");e.set(l,t)},t.setIdToken=function(e){var t=u("id_token");e.set(o,t)},t.isLoggedIn=function(){var e=s();return!!e&&!function(e){return function(e){var t=(0,n.default)(e);if(!t.exp)return null;var a=new Date(0);return a.setUTCSeconds(t.exp),a}(e)<new Date}(e)};var n=r(a(41));function r(e){return e&&e.__esModule?e:{default:e}}var o="id_token",l="access_token",i=new(r(a(42)).default.WebAuth)({domain:"buldreinfo.auth0.com",clientID:"zexpFfou6HkgNWH5QVi3zyT1rrw6MXAn"});function s(e){return e.get(o)}function u(e){var t=RegExp("[#&]"+e+"=([^&]*)").exec(window.location.hash);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}},function(e,t){e.exports=require("react-dom")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=w(a(30)),r=w(a(37)),o=w(a(39)),l=w(a(40)),i=w(a(43)),s=w(a(44)),u=w(a(45)),c=w(a(49)),d=w(a(50)),f=w(a(51)),m=w(a(53)),h=w(a(57)),p=w(a(58)),b=w(a(59)),y=w(a(60)),g=w(a(61)),v=w(a(63)),E=a(6);function w(e){return e&&e.__esModule?e:{default:e}}var k=[{path:"/",exact:!0,component:u.default,fetchInitialData:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,E.getFrontpage)(e)}},{path:"/browse",exact:!1,component:o.default,fetchInitialData:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,E.getBrowse)(e)}},{path:"/callback",exact:!1,component:l.default},{path:"/ethics",exact:!1,component:i.default,fetchInitialData:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,E.getMeta)(e)}},{path:"/area/:areaId",exact:!0,component:n.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getArea)(e,t.split("/").pop())}},{path:"/area/edit/:areaId",exact:!0,component:r.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getAreaEdit)(e,t.split("/").pop())}},{path:"/sector/:sectorId",exact:!0,component:p.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getSector)(e,t.split("/").pop())}},{path:"/sector/edit/:sectorId",exact:!0,component:b.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getSectorEdit)(e,t.split("/").pop())}},{path:"/problem/:problemId",exact:!0,component:f.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getProblem)(e,t.split("/").pop())}},{path:"/problem/edit/:problemId",exact:!0,component:m.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getProblemEdit)(e,t.split("/").pop())}},{path:"/problem/edit/media/:problemId",exact:!0,component:h.default},{path:"/problem/svg-edit/:problemIdMediaId",exact:!0,component:y.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getSvgEdit)(e,t.split("/").pop())}},{path:"/finder/:grade",exact:!0,component:s.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getFinder)(e,t.split("/").pop())}},{path:"/user",exact:!0,component:g.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getUser)(e,t.split("/").pop())}},{path:"/user/:userId",exact:!0,component:g.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getUser)(e,t.split("/").pop())}},{path:"/user/:userId/edit",exact:!0,component:v.default,fetchInitialData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,E.getUserEdit)(e,t.split("/").pop())}},{path:"/login",exact:!1,component:c.default},{path:"/logout",exact:!1,component:d.default}];t.default=k},function(e,t){e.exports=require("svg-path-parser")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePath=function(e){if(e){var t=(0,r.parseSVG)(e);return(0,r.makeAbsolute)(t),t.map(function(e){switch(e.code){case"L":case"M":return{x:Math.round(e.x),y:Math.round(e.y)};case"C":return{x:Math.round(e.x),y:Math.round(e.y),c:[{x:Math.round(e.x1),y:Math.round(e.y1)},{x:Math.round(e.x2),y:Math.round(e.y2)}]};case"S":return{x:Math.round(e.x),y:Math.round(e.y),c:[{x:Math.round(e.x0),y:Math.round(e.y0)},{x:Math.round(e.x2),y:Math.round(e.y2)}]}}})}return[]},t.parseReadOnlySvgs=function(e,t,a){var l=[],i=!0,s=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){var f=c.value;l.push(n.default.createElement("path",{key:l.length,d:f.path,className:"buldreinfo-svg-opacity buldreinfo-svg-route",strokeWidth:.003*t,strokeDasharray:.006*t}));var m=(0,r.parseSVG)(f.path);(0,r.makeAbsolute)(m),l.push(o(m,f.nr,f.hasAnchor,t,a))}}catch(e){s=!0,u=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw u}}return l};var n=function(e){return e&&e.__esModule?e:{default:e}}(a(0)),r=a(18);function o(e,t,a,r,o){for(var l,i,s=0,u=99999999,c=0,d=e.length;c<d;c++)e[c].y>s&&(l=c,s=e[c].y),e[c].y<u&&(i=c,u=e[c].y);var f=e[l].x,m=e[l].y,h=.012*r;f<h&&(f=h),f>r-h&&(f=r-h),m<h&&(m=h),m>o-h&&(m=o-h);var p=null;return!0===a&&(p=n.default.createElement("circle",{className:"buldreinfo-svg-ring",cx:e[i].x,cy:e[i].y,r:.006*r})),n.default.createElement("g",{className:"buldreinfo-svg-opacity"},n.default.createElement("circle",{className:"buldreinfo-svg-ring",cx:f,cy:m,r:h}),n.default.createElement("text",{className:"buldreinfo-svg-routenr",x:f,y:m,fontSize:.02*r},t),p)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=d(r),l=(a(2),a(1)),i=a(3),s=d(a(21)),u=a(5),c=a(6);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"refresh",value:function(e){var t=null;e.date?t=e.date:-1==e.idTick&&(t=(0,c.convertFromDateToString)(new Date)),this.setState({idTick:e.idTick,idProblem:e.idProblem,date:t,comment:e.comment?e.comment:"",grade:e.grade,stars:e.stars?e.stars:0,grades:e.grades})}},{key:"componentDidMount",value:function(){this.refresh(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.refresh(e)}},{key:"onDateChanged",value:function(e){this.setState({date:e})}},{key:"onCommentChanged",value:function(e){this.setState({comment:e.target.value})}},{key:"onStarsChanged",value:function(e,t){this.setState({stars:e})}},{key:"onGradeChanged",value:function(e,t){this.setState({grade:e})}},{key:"delete",value:function(e){var t=this,a=this.props.cookies.get("access_token");(0,c.postTicks)(a,!0,this.state.idTick,this.state.idProblem,this.state.comment,this.state.date,this.state.stars,this.state.grade).then(function(e){t.props.onHide()}).catch(function(e){console.warn(e),alert(e.toString())})}},{key:"save",value:function(e){var t=this,a=this.props.cookies.get("access_token");(0,c.postTicks)(a,!1,this.state.idTick,this.state.idProblem,this.state.comment,this.state.date,this.state.stars,this.state.grade).then(function(e){t.props.onHide()}).catch(function(e){console.warn(e),alert(e.toString())})}},{key:"render",value:function(){var e=this,t=new Date;t.setDate(t.getDate()-1);var a="No stars";return this.state&&(1===this.state.stars?a=o.default.createElement("span",null,o.default.createElement(u.FontAwesomeIcon,{icon:"star"})," Nice"):2===this.state.stars?a=o.default.createElement("span",null,o.default.createElement(u.FontAwesomeIcon,{icon:"star"}),o.default.createElement(u.FontAwesomeIcon,{icon:"star"})," Very nice"):3===this.state.stars&&(a=o.default.createElement("span",null,o.default.createElement(u.FontAwesomeIcon,{icon:"star"}),o.default.createElement(u.FontAwesomeIcon,{icon:"star"}),o.default.createElement(u.FontAwesomeIcon,{icon:"star"})," Fantastic!"))),o.default.createElement(i.Modal,{show:this.props.show,onHide:this.props.onHide.bind(this)},o.default.createElement(i.Modal.Header,{closeButton:!0},o.default.createElement(i.Modal.Title,null,"Tick")),o.default.createElement(i.Modal.Body,null,o.default.createElement(i.FormGroup,null,o.default.createElement(i.ControlLabel,null,"Date (yyyy-mm-dd)"),o.default.createElement("br",null),o.default.createElement(s.default,{format:"YYYY-MM-DD",computableFormat:"YYYY-MM-DD",date:this.state&&this.state.date,onChange:this.onDateChanged.bind(this)}),o.default.createElement(i.ButtonGroup,null,o.default.createElement(i.Button,{onClick:this.onDateChanged.bind(this,(0,c.convertFromDateToString)(t))},"Yesterday"),o.default.createElement(i.Button,{onClick:this.onDateChanged.bind(this,(0,c.convertFromDateToString)(new Date))},"Today"))),o.default.createElement(i.FormGroup,null,o.default.createElement(i.ControlLabel,null,"Grade"),o.default.createElement("br",null),o.default.createElement(i.DropdownButton,{title:this.state?this.state.grade:"Loading",id:"bg-nested-dropdown"},this.state&&this.state.grades&&this.state.grades.map(function(t,a){return o.default.createElement(i.MenuItem,{key:a,eventKey:a,onSelect:e.onGradeChanged.bind(e,t.grade)},t.grade)}))),o.default.createElement(i.FormGroup,null,o.default.createElement(i.ControlLabel,null,"Stars"),o.default.createElement("br",null),o.default.createElement(i.DropdownButton,{title:a,id:"bg-nested-dropdown"},o.default.createElement(i.MenuItem,{eventKey:"0",onSelect:this.onStarsChanged.bind(this,0)},"No stars"),o.default.createElement(i.MenuItem,{eventKey:"1",onSelect:this.onStarsChanged.bind(this,1)},o.default.createElement(u.FontAwesomeIcon,{icon:"star"})," Nice"),o.default.createElement(i.MenuItem,{eventKey:"2",onSelect:this.onStarsChanged.bind(this,2)},o.default.createElement(u.FontAwesomeIcon,{icon:"star"}),o.default.createElement(u.FontAwesomeIcon,{icon:"star"})," Very nice"),o.default.createElement(i.MenuItem,{eventKey:"3",onSelect:this.onStarsChanged.bind(this,3)},o.default.createElement(u.FontAwesomeIcon,{icon:"star"}),o.default.createElement(u.FontAwesomeIcon,{icon:"star"}),o.default.createElement(u.FontAwesomeIcon,{icon:"star"})," Fantastic!"))),o.default.createElement(i.FormGroup,null,o.default.createElement(i.ControlLabel,null,"Comment"),o.default.createElement(i.FormControl,function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({componentClass:"textarea",placeholder:"textarea",style:{height:"100px"},value:this.state&&this.state.comment,onChange:this.onCommentChanged.bind(this)},"placeholder","Comment")))),o.default.createElement(i.Modal.Footer,null,o.default.createElement(i.ButtonGroup,null,o.default.createElement(i.Button,{onClick:this.save.bind(this),bsStyle:"success"},"Save"),this.state&&this.state.idTick>1?o.default.createElement(i.Button,{onClick:this.delete.bind(this),bsStyle:"warning"},"Delete tick"):"",o.default.createElement(i.Button,{onClick:this.props.onHide.bind(this)},"Close"))))}}]),t}();t.default=(0,l.withCookies)(f)},function(e,t){e.exports=require("react-input-calendar")},function(e,t){e.exports=require("create-react-class")},function(e,t,a){"use strict";var n=h(a(24)),r=h(a(25)),o=h(a(0)),l=a(26),i=a(4),s=h(a(27)),u=a(1),c=h(a(28)),d=a(7),f=h(a(29)),m=h(a(17));function h(e){return e&&e.__esModule?e:{default:e}}var p=(0,n.default)(),b=a(71);p.use((0,r.default)()),p.use(b()),p.use(n.default.static("public")),p.get("*",function(e,t,a){var n=(0,c.default)();global.myOrigin=e.protocol+"://"+e.headers.host;var r=m.default.find(function(t){return(0,i.matchPath)(e.url,t)})||{};(r.fetchInitialData?r.fetchInitialData(e.universalCookies.get("access_token"),e.path):Promise.resolve()).then(function(a){var r={data:a},c=(0,l.renderToString)(o.default.createElement(u.CookiesProvider,{cookies:e.universalCookies},o.default.createElement(d.MetaTagsContext,{extract:n.extract},o.default.createElement(i.StaticRouter,{location:e.url,context:r},o.default.createElement(f.default,null))))),m=n.renderToString();t.send('\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset="utf-8">\n          '+m+'\n          <meta name="viewport" content="width=device-width, initial-scale=1">\n          <link rel="icon" href="/favicon.ico">\n          <meta name="author" content="Jostein Øygarden">\n          <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">\n          <link rel="stylesheet" type="text/css" href="/css/react-input-calendar.css">\n          <link rel="stylesheet" type="text/css" href="/css/image-gallery.css">\n          <link rel="stylesheet" type="text/css" href="/css/react-bootstrap-table.css">\n          <link rel="stylesheet" type="text/css" href="/css/buldreinfo.css">\n          <script src="/js/bundle.js" defer><\/script>\n          <script>window.__INITIAL_DATA__ = '+(0,s.default)(a)+'<\/script>\n        </head>\n\n        <body>\n          <div id="app">'+c+"</div>\n        </body>\n      </html>\n    ")}).catch(function(e){return console.warn(e)})}),p.listen(3e3,function(){console.log("Server is listening on port: 3000")})},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("serialize-javascript")},function(e,t){e.exports=require("react-meta-tags/server")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(0),l=m(o),i=m(a(16)),s=a(4),u=m(a(17)),c=m(a(64)),d=(m(a(68)),a(69)),f=(a(5),a(70));function m(e){return e&&e.__esModule?e:{default:e}}function h(e){return null}d.library.add(f.faCamera),d.library.add(f.faCheck),d.library.add(f.faComment),d.library.add(f.faEdit),d.library.add(f.faHashtag),d.library.add(f.faImage),d.library.add(f.faLock),d.library.add(f.faMapMarker),d.library.add(f.faPlane),d.library.add(f.faPlusSquare),d.library.add(f.faSpinner),d.library.add(f.faStar),d.library.add(f.faStarHalf),d.library.add(f.faTrash),d.library.add(f.faUserSecret),d.library.add(f.faVideo);var p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"componentDidMount",value:function(){var e=i.default.findDOMNode(this).querySelector("nav.navbar"),t=e.querySelector("div.navbar-collapse"),a=e.querySelector("button.navbar-toggle");e.addEventListener("click",function(e){"A"===e.target.tagName&&!e.target.classList.contains("dropdown-toggle")&&t.classList.contains("in")&&a.click()},!1)}},{key:"render",value:function(){return l.default.createElement("span",null,l.default.createElement(c.default,null),l.default.createElement("div",{className:"container"},l.default.createElement(s.Route,{path:"/",component:h}),l.default.createElement(s.Switch,null,u.default.map(function(e){var t=e.path,a=e.exact,r=e.component,o=function(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,["path","exact","component"]);return l.default.createElement(s.Route,{key:t,path:t,exact:a,render:function(e){return l.default.createElement(r,n({},e,o))}})})),l.default.createElement("footer",{style:{paddingTop:"10px",marginTop:"40px",color:"#777",textAlign:"center",borderTop:"1px solid #e5e5e5"}},"buldreinfo.com & brattelinjer.no © 2006-2018")))}}]),t}();t.default=p},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=p(r),l=a(2),i=a(1),s=p(a(7)),u=a(4),c=a(3),d=a(9),f=p(a(10)),m=p(a(13)),h=a(5);function p(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function t(){return b(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return g(t,r.Component),n(t,[{key:"render",value:function(){var e="";if(this.props.sector.comment)if(this.props.sector.comment.length>100){var t=o.default.createElement(c.Tooltip,{id:this.props.sector.id},this.props.sector.comment);e=o.default.createElement(c.OverlayTrigger,{key:this.props.sector.id,placement:"top",overlay:t},o.default.createElement("span",null,this.props.sector.comment.substring(0,100)+"..."))}else e=this.props.sector.comment;return o.default.createElement("tr",null,o.default.createElement("td",null,o.default.createElement(u.Link,{to:"/sector/"+this.props.sector.id},this.props.sector.name)," ",1===this.props.sector.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===this.props.sector.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"})),o.default.createElement("td",null,e),o.default.createElement("td",null,this.props.sector.numProblems))}}]),t}(),E=function(e){function t(e){b(this,t);var a=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n,tabIndex:1},a}return g(t,r.Component),n(t,[{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.areaId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.areaId!==this.props.match.params.areaId&&this.refresh(this.props.match.params.areaId)}},{key:"handleTabsSelection",value:function(e){this.setState({tabIndex:e})}},{key:"onRemoveMedia",value:function(e){var t=this.state.data.media.filter(function(t){return t.id!=e});this.setState({media:t})}},{key:"render",value:function(){if(!this.state.data)return o.default.createElement("center",null,o.default.createElement(h.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));var e=this.state.data.sectors.map(function(e,t){return o.default.createElement(v,{sector:e,key:t})}),t=this.state.data.sectors.filter(function(e){return 0!=e.lat&&0!=e.lng}).map(function(e){return{lat:e.lat,lng:e.lng,title:e.name,icon:{url:"https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png",scaledSizeW:32,scaledSizeH:32},url:"/sector/"+e.id}}),a=this.state.data.sectors.filter(function(e){return e.polygonCoords}).map(function(e){return{triangleCoords:e.polygonCoords.split(";").map(function(e,t){var a=e.split(",");return{lat:parseFloat(a[0]),lng:parseFloat(a[1])}}),url:"/sector/"+e.id}}),n=this.state.data.lat&&this.state.data.lat>0?{lat:this.state.data.lat,lng:this.state.data.lng}:this.state.data.metadata.defaultCenter,r=this.state.data.lat&&this.state.data.lat>0?14:this.state.data.metadata.defaultZoom,l=t.length>0||a.length>0?o.default.createElement(f.default,{markers:t,polygons:a,defaultCenter:n,defaultZoom:r}):null,i=this.state.data.media&&this.state.data.media.length>0?o.default.createElement(m.default,{isAdmin:this.state.data.metadata.isAdmin,alt:this.state.data.name,media:this.state.data.media,showThumbnails:this.state.data.media.length>1,removeMedia:this.onRemoveMedia.bind(this)}):null,p=null;return l&&i?p=o.default.createElement(c.Tabs,{activeKey:this.state.tabIndex,animation:!1,onSelect:this.handleTabsSelection.bind(this),id:"area_tab",unmountOnExit:!0},o.default.createElement(c.Tab,{eventKey:1,title:"Topo"},1==this.state.tabIndex&&i),o.default.createElement(c.Tab,{eventKey:2,title:"Map"},2==this.state.tabIndex&&l)):l?p=l:i&&(p=i),o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(this.state.data.metadata.jsonLd)}}),o.default.createElement("title",null,this.state.data.metadata.title),o.default.createElement("meta",{name:"description",content:this.state.data.metadata.description})),o.default.createElement(c.Breadcrumb,null,this.state.data.metadata.isAdmin?o.default.createElement("div",{style:{float:"right"}},o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.OverlayTrigger,{placement:"top",overlay:o.default.createElement(c.Tooltip,{id:-1},"Add sector")},o.default.createElement(d.LinkContainer,{to:{pathname:"/sector/edit/-1",query:{idArea:this.state.data.id,lat:this.state.data.lat,lng:this.state.data.lng}}},o.default.createElement(c.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(h.FontAwesomeIcon,{icon:"plus-square",inverse:!0})))),o.default.createElement(c.OverlayTrigger,{placement:"top",overlay:o.default.createElement(c.Tooltip,{id:this.state.data.id},"Edit area")},o.default.createElement(d.LinkContainer,{to:{pathname:"/area/edit/"+this.state.data.id,query:{lat:this.state.data.lat,lng:this.state.data.lng}}},o.default.createElement(c.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(h.FontAwesomeIcon,{icon:"edit",inverse:!0})))))):null,o.default.createElement(u.Link,{to:"/"},"Home")," / ",o.default.createElement(u.Link,{to:"/browse"},"Browse")," / ",o.default.createElement("font",{color:"#777"},this.state.data.name)," ",1===this.state.data.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===this.state.data.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"})),p,this.state.data.comment?o.default.createElement(c.Well,null,o.default.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.data.comment}})):null,o.default.createElement(c.Table,{striped:!0,condensed:!0,hover:!0},o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("th",null,"Name"),o.default.createElement("th",null,"Description"),o.default.createElement("th",null,"#problems"))),o.default.createElement("tbody",null,e)))}}]),t}();E.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(E)},function(e,t){e.exports=require("react-google-maps/lib/components/addons/MarkerClusterer")},function(e,t){e.exports=require("react-image-gallery")},function(e,t){e.exports=require("react-player")},function(e,t){e.exports=require("object-fit-images")},function(e,t){e.exports=require("isomorphic-fetch")},function(e,t){e.exports=require("es6-promise")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=p(r),l=a(2),i=a(1),s=p(a(7)),u=a(8),c=a(3),d=p(a(12)),f=a(11),m=a(5),h=a(6);function p(e){return e&&e.__esModule?e:{default:e}}var b=(0,f.withScriptjs)((0,f.withGoogleMap)(function(e){return o.default.createElement(f.GoogleMap,{defaultZoom:e.defaultZoom,defaultCenter:e.defaultCenter,defaultMapTypeId:google.maps.MapTypeId.TERRAIN,onClick:e.onClick.bind(void 0)},e.markers)})),y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.areaId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.areaId!==this.props.match.params.areaId&&this.refresh(this.props.match.params.areaId)}},{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"onNameChanged",value:function(e){var t=this.state.data;t.name=e.target.value,this.setState({data:t})}},{key:"onVisibilityChanged",value:function(e,t){var a=this.state.data;a.visibility=e,this.setState({data:a})}},{key:"onCommentChanged",value:function(e){var t=this.state.data;t.comment=e.target.value,this.setState({data:t})}},{key:"onNewMediaChanged",value:function(e){var t=this.state.data;t.newMedia=e,this.setState({data:t})}},{key:"save",value:function(e){var t=this;e.preventDefault();var a=this.props.cookies.get("access_token");this.setState({isSaving:!0}),(0,h.postArea)(a,this.state.data.id,this.state.data.visibility,this.state.data.name,this.state.data.comment,this.state.data.lat,this.state.data.lng,this.state.data.newMedia).then(function(e){t.setState({pushUrl:"/area/"+e.id})}).catch(function(e){console.warn(e),t.setState({error:e})})}},{key:"onMarkerClick",value:function(e){var t=this.state.data;t.lat=e.latLng.lat(),t.lng=e.latLng.lng(),this.setState({data:t})}},{key:"onCancel",value:function(){window.history.back()}},{key:"render",value:function(){if(this.state.error)return o.default.createElement("h3",null,this.state.error.toString());if(this.state.pushUrl)return o.default.createElement(u.Redirect,{to:this.state.pushUrl,push:!0});if(!(this.props&&this.props.match&&this.props.match.params&&this.props.match.params.areaId))return o.default.createElement("span",null,o.default.createElement("h3",null,"Invalid action..."));if(!this.state.data)return o.default.createElement("center",null,o.default.createElement(m.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));this.state.data.metadata.isAdmin||this.setState({pushUrl:"/login",error:null});var e="Visible for everyone";1===this.state.data.visibility?e="Only visible for administrators":2===this.state.data.visibility&&(e="Only visible for super administrators");var t=this.props&&this.props.location&&this.props.location.query&&this.props.location.query.lat&&parseFloat(this.props.location.query.lat)>0?{lat:parseFloat(this.props.location.query.lat),lng:parseFloat(this.props.location.query.lng)}:this.state.data.metadata.defaultCenter,a=this.props&&this.props.location&&this.props.location.query&&this.props.location.query.lat&&parseFloat(this.props.location.query.lat)>0?8:this.state.data.metadata.defaultZoom;return o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("title",null,this.state.data.metadata.title)),o.default.createElement(c.Well,null,o.default.createElement("form",{onSubmit:this.save.bind(this)},o.default.createElement(c.FormGroup,{controlId:"formControlsName"},o.default.createElement(c.ControlLabel,null,"Area name"),o.default.createElement(c.FormControl,{type:"text",value:this.state.data.name,placeholder:"Enter name",onChange:this.onNameChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsComment"},o.default.createElement(c.ControlLabel,null,"Comment"),o.default.createElement(c.FormControl,{style:{height:"100px"},componentClass:"textarea",placeholder:"Enter comment",value:this.state.data.comment,onChange:this.onCommentChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsVisibility"},o.default.createElement(c.ControlLabel,null,"Visibility"),o.default.createElement("br",null),o.default.createElement(c.DropdownButton,{title:e,id:"bg-nested-dropdown"},o.default.createElement(c.MenuItem,{eventKey:"0",onSelect:this.onVisibilityChanged.bind(this,0)},"Visible for everyone"),o.default.createElement(c.MenuItem,{eventKey:"1",onSelect:this.onVisibilityChanged.bind(this,1)},"Only visible for administrators"),this.state.data.metadata.isSuperAdmin&&o.default.createElement(c.MenuItem,{eventKey:"2",onSelect:this.onVisibilityChanged.bind(this,2)},"Only visible for super administrators"))),o.default.createElement(c.FormGroup,{controlId:"formControlsMedia"},o.default.createElement(d.default,{onMediaChanged:this.onNewMediaChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsMap"},o.default.createElement(c.ControlLabel,null,"Click to mark area center on map"),o.default.createElement("br",null),o.default.createElement("section",{style:{height:"600px"}},o.default.createElement(b,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCpaVd5518yMB-oiIyP5JnTVWMfrOv4sAI&v=3.exp",loadingElement:o.default.createElement("div",{style:{height:"100%"}}),containerElement:o.default.createElement("div",{style:{height:"100%"}}),mapElement:o.default.createElement("div",{style:{height:"100%"}}),defaultZoom:a,defaultCenter:t,onClick:this.onMarkerClick.bind(this),markers:0!=this.state.data.lat&&0!=this.state.data.lng?o.default.createElement(f.Marker,{position:{lat:this.state.data.lat,lng:this.state.data.lng}}):""}))),o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.Button,{bsStyle:"danger",onClick:this.onCancel.bind(this)},"Cancel"),o.default.createElement(c.Button,{type:"submit",bsStyle:"success",disabled:this.state.isSaving},this.state.isSaving?"Saving...":"Save area")))))}}]),t}();y.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(y)},function(e,t){e.exports=require("react-dropzone")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=p(r),l=a(2),i=a(1),s=p(a(7)),u=a(4),c=a(3),d=a(14),f=a(9),m=p(a(10)),h=a(5);function p(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;if(navigator.geolocation.getCurrentPosition(function(t){e.setState({currLat:t.coords.latitude,currLng:t.coords.longitude})}),!this.state.data){var t=this.props.cookies.get("access_token");this.props.fetchInitialData(t).then(function(t){return e.setState(function(){return{data:t}})})}}},{key:"formatName",value:function(e,t){return o.default.createElement("span",null,o.default.createElement(u.Link,{to:"/area/"+t.id},t.name)," ",1===t.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===t.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"}))}},{key:"toRad",value:function(e){return e*Math.PI/180}},{key:"calcCrow",value:function(e,t,a,n){var r=this.toRad(a-e),o=this.toRad(n-t),l=(e=this.toRad(e),a=this.toRad(a),Math.sin(r/2)*Math.sin(r/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(e)*Math.cos(a));return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}},{key:"formatDistance",value:function(e,t){return this.state.currLat>0&&this.state.currLng>0&&t.lat>0&&t.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,t.lat,t.lng).toFixed(1)+" km":""}},{key:"sortDistance",value:function(e,t,a){var n=this.state.currLat>0&&this.state.currLng>0&&e.lat>0&&e.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,e.lat,e.lng):0,r=this.state.currLat>0&&this.state.currLng>0&&t.lat>0&&t.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,t.lat,t.lng):0;return"asc"===a?n<r?-1:n>r?1:0:n<r?1:n>r?-1:0}},{key:"render",value:function(){if(!this.state||!this.state.data)return o.default.createElement("center",null,o.default.createElement(h.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));var e=this.state.data.areas.filter(function(e){return 0!=e.lat&&0!=e.lng}).map(function(e){return{lat:e.lat,lng:e.lng,title:e.name,label:e.name.charAt(0),url:"/area/"+e.id}}),t=e.length>0?o.default.createElement(m.default,{markers:e,defaultCenter:this.state.data.metadata.defaultCenter,defaultZoom:this.state.data.metadata.defaultZoom}):null;return o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("title",null,this.state.data.metadata.title),o.default.createElement("meta",{name:"description",content:this.state.data.metadata.description})),o.default.createElement(c.Breadcrumb,null,this.state.data.metadata.isAdmin&&o.default.createElement(c.OverlayTrigger,{placement:"top",overlay:o.default.createElement(c.Tooltip,{id:-1},"Add area")},o.default.createElement("div",{style:{float:"right"}},o.default.createElement(f.LinkContainer,{to:"/area/edit/-1"},o.default.createElement(c.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(h.FontAwesomeIcon,{icon:"plus-square",inverse:!0}))))),o.default.createElement(u.Link,{to:"/"},"Home")," / ",o.default.createElement("font",{color:"#777"},"Browse")),t,o.default.createElement(d.BootstrapTable,{data:this.state.data.areas,condensed:!0,hover:!0,columnFilter:!1},o.default.createElement(d.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"id"),o.default.createElement(d.TableHeaderColumn,{dataField:"name",dataSort:!0,dataFormat:this.formatName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Name"),o.default.createElement(d.TableHeaderColumn,{dataField:"numSectors",dataSort:!0,dataAlign:"center",width:"50"},"#sectors"),o.default.createElement(d.TableHeaderColumn,{dataField:"numProblems",dataSort:!0,dataAlign:"center",width:"50"},"#problems"),o.default.createElement(d.TableHeaderColumn,{dataField:"distance",dataSort:!0,dataFormat:this.formatDistance.bind(this),sortFunc:this.sortDistance.bind(this),dataAlign:"center",width:"60"},o.default.createElement(h.FontAwesomeIcon,{icon:"plane"}))))}}]),t}();b.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(b)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(2),i=a(1),s=a(3),u=a(15);var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this.props.cookies;(0,u.setAccessToken)(e),(0,u.setIdToken)(e),window.location.href="/"}},{key:"render",value:function(){return o.default.createElement(s.Well,null,"Logging in, please wait")}}]),t}();c.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(c)},function(e,t){e.exports=require("jwt-decode")},function(e,t){e.exports=require("auth0-js")},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=d(r),l=a(2),i=a(1),s=d(a(7)),u=a(4),c=a(3);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;if(!this.state.data){var t=this.props.cookies.get("access_token");this.props.fetchInitialData(t).then(function(t){return e.setState(function(){return{data:t}})})}}},{key:"render",value:function(){return o.default.createElement("span",null,o.default.createElement(s.default,null,this.state.data&&o.default.createElement("title",null,"Ethics | "+this.state.data.metadata.title),o.default.createElement("meta",{name:"description",content:"Ethics and privacy policy"})),o.default.createElement(c.Breadcrumb,null,o.default.createElement(u.Link,{to:"/"},"Home")," / ",o.default.createElement("font",{color:"#777"},"Ethics")),o.default.createElement(c.Well,null,"If you're going out climbing, we ask you to please follow these guidelines for the best possible bouldering experience now, and for the future generations of climbers.",o.default.createElement("br",null),o.default.createElement("br",null),o.default.createElement("ul",null,o.default.createElement("li",null,"Show respect for the landowners, issue care and be polite."),o.default.createElement("li",null,"Follow paths where possible, and do not cross cultivated land."),o.default.createElement("li",null,"Take your trash back with you."),o.default.createElement("li",null,"Park with reason, and think of others. Make room for potential tractors and such if necessary."),o.default.createElement("li",null,"Start where directed, and don't hesitate to ask if your unsure."),o.default.createElement("li",null,"Sit start means that the behind should be the last thing to leave the ground/crashpad."),o.default.createElement("li",null,"No chipping allowed."),o.default.createElement("li",null,"Remember climbing can be dangerous and always involves risk. Your safety is your own responsibility."),o.default.createElement("li",null,"Use common sense!"))),o.default.createElement(c.Well,null,o.default.createElement("h3",null,"Privacy Policy"),"We respect your privacy and handle your data with the care that we would expect our own data to be handled. We will never sell or pass on your information to any third party. You can delete any of your profile information at any time, ",o.default.createElement("a",{href:"mailto:jostein.oygarden@gmail.com"},"send us an e-mail")," with the data you want to delete. The Android app requests permissions like accounts and camera. Accounts are used to give you correct data according to your permissions in buldreinfo. The camera can be used inside the app to append new images to existing bouldering problems (pending approval by an administrator)."))}}]),t}();f.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(f)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=p(r),l=a(2),i=a(1),s=p(a(7)),u=a(4),c=a(9),d=p(a(10)),f=a(3),m=a(14),h=a(5);function p(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n,tabIndex:1,currLat:0,currLng:0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"toRad",value:function(e){return e*Math.PI/180}},{key:"calcCrow",value:function(e,t,a,n){var r=this.toRad(a-e),o=this.toRad(n-t),l=(e=this.toRad(e),a=this.toRad(a),Math.sin(r/2)*Math.sin(r/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(e)*Math.cos(a));return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}},{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"componentDidMount",value:function(){var e=this;this.state.data||this.refresh(this.props.match.params.grade),navigator.geolocation.getCurrentPosition(function(t){e.setState({currLat:t.coords.latitude,currLng:t.coords.longitude})})}},{key:"componentDidUpdate",value:function(e,t){e.match.params.grade!==this.props.match.params.grade&&this.refresh(this.props.match.params.grade)}},{key:"handleTabsSelection",value:function(e){this.setState({tabIndex:e})}},{key:"trClassFormat",value:function(e,t){return e.ticked?"success":""}},{key:"formatAreaName",value:function(e,t){return o.default.createElement("span",null,o.default.createElement(u.Link,{to:"/area/"+t.areaId},t.areaName)," ",1===t.areaVisibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===t.areaVisibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"}))}},{key:"formatSectorName",value:function(e,t){return o.default.createElement("span",null,o.default.createElement(u.Link,{to:"/sector/"+t.sectorId},t.sectorName)," ",1===t.sectorVisibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===t.sectorVisibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"}))}},{key:"formatName",value:function(e,t){return o.default.createElement("span",null,o.default.createElement(u.Link,{to:"/problem/"+t.id},t.name)," ",1===t.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===t.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"}))}},{key:"formatType",value:function(e,t){var a;switch(t.t.id){case 2:a=o.default.createElement("img",{height:"20",src:"/jpg/bolt.jpg",alt:"Bolt"});break;case 3:a=o.default.createElement("img",{height:"20",src:"/jpg/trad.jpg",alt:"Trad"});break;case 4:a=o.default.createElement("img",{height:"20",src:"/jpg/mixed.jpg",alt:"Mixed"})}return o.default.createElement(f.OverlayTrigger,{placement:"top",overlay:o.default.createElement(f.Popover,{id:t.t.id,title:"Type"}," ",t.t.type+" - "+t.t.subType)},a)}},{key:"formatFa",value:function(e,t){var a=t.fa?t.fa.map(function(e,t){var a=o.default.createElement(f.Tooltip,{id:t},e.firstname," ",e.surname);return o.default.createElement(f.OverlayTrigger,{key:t,placement:"top",overlay:a},o.default.createElement(c.LinkContainer,{key:t,to:"/user/"+e.id},o.default.createElement(f.Button,{key:t,bsStyle:"default"},e.initials)))}):[];return o.default.createElement(f.ButtonToolbar,null,o.default.createElement(f.ButtonGroup,{bsSize:"xsmall"},a))}},{key:"formatStars",value:function(e,t){var a=null;if(.5===t.stars)a=o.default.createElement(h.FontAwesomeIcon,{icon:"star-half"});else if(1===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:2},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}));else if(1.5===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:3},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star-half"}));else if(2===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:4},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}));else if(2.5===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:5},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star-half"}));else{if(3!==t.stars)return"";a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:6},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}))}return o.default.createElement(f.OverlayTrigger,{placement:"top",overlay:o.default.createElement(f.Popover,{id:0,title:"Guidelines"},o.default.createElement(h.FontAwesomeIcon,{icon:"star"})," Nice",o.default.createElement("br",null),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"})," Very nice",o.default.createElement("br",null),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"})," Fantastic!")},a)}},{key:"formatNumImages",value:function(e,t){return t.media?t.media.filter(function(e){return 1===e.idType}).length:0}},{key:"formatNumMovies",value:function(e,t){return t.media?t.media.filter(function(e){return 2===e.idType}).length:0}},{key:"formatDistance",value:function(e,t){return this.state.currLat>0&&this.state.currLng>0&&t.lat>0&&t.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,t.lat,t.lng).toFixed(1)+" km":""}},{key:"sortFa",value:function(e,t,a){var n=e.fa?e.fa[0].initials:"",r=t.fa?t.fa[0].initials:"";return"asc"===a?n.localeCompare(r):r.localeCompare(n)}},{key:"sortNumImages",value:function(e,t,a){var n=e.media?e.media.filter(function(e){return 1===e.idType}).length:0,r=t.media?t.media.filter(function(e){return 1===e.idType}).length:0;return"asc"===a?n<r?-1:n>r?1:0:n<r?1:n>r?-1:0}},{key:"sortNumMovies",value:function(e,t,a){var n=e.media?e.media.filter(function(e){return 2===e.idType}).length:0,r=t.media?t.media.filter(function(e){return 2===e.idType}).length:0;return"asc"===a?n<r?-1:n>r?1:0:n<r?1:n>r?-1:0}},{key:"sortDistance",value:function(e,t,a){var n=this.state.currLat>0&&this.state.currLng>0&&e.lat>0&&e.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,e.lat,e.lng):0,r=this.state.currLat>0&&this.state.currLng>0&&t.lat>0&&t.lng>0?this.calcCrow(this.state.currLat,this.state.currLng,t.lat,t.lng):0;return"asc"===a?n<r?-1:n>r?1:0:n<r?1:n>r?-1:0}},{key:"render",value:function(){if(!this.state.data||!this.state.data.problems)return o.default.createElement("center",null,o.default.createElement(h.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));var e=this.state.data.problems.filter(function(e){return 0!=e.lat&&0!=e.lng}).map(function(e){return{lat:e.lat,lng:e.lng,title:e.nr+" - "+e.name+" ["+e.grade+"]",label:e.name.charAt(0),url:"/problem/"+e.id,icon:{url:e.ticked?"https://mt.google.com/vt/icon?name=icons/spotlight/spotlight-waypoint-a.png":"https://mt.google.com/vt/icon?name=icons/spotlight/spotlight-waypoint-b.png",labelOriginX:11,labelOriginY:13}}}),t=e.length>0?o.default.createElement(d.default,{markers:e,defaultCenter:this.state.data.metadata.defaultCenter,defaultZoom:7}):null,a=null;return a=this.state.data.metadata.isBouldering?o.default.createElement(m.BootstrapTable,{data:this.state.data.problems,trClassName:this.trClassFormat.bind(this),condensed:!0,hover:!0,columnFilter:!1},o.default.createElement(m.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"id"),o.default.createElement(m.TableHeaderColumn,{dataField:"areaName",dataSort:!0,dataFormat:this.formatAreaName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Area"),o.default.createElement(m.TableHeaderColumn,{dataField:"sectorName",dataSort:!0,dataFormat:this.formatSectorName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Sector"),o.default.createElement(m.TableHeaderColumn,{dataField:"name",dataSort:!0,dataFormat:this.formatName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Name"),o.default.createElement(m.TableHeaderColumn,{dataField:"grade",dataSort:!0,dataAlign:"center",width:"70"},"Grade"),o.default.createElement(m.TableHeaderColumn,{dataField:"fa",dataSort:!0,dataFormat:this.formatFa.bind(this),sortFunc:this.sortFa.bind(this),dataAlign:"center",width:"70"},"FA"),o.default.createElement(m.TableHeaderColumn,{dataField:"numTicks",dataSort:!0,dataAlign:"center",width:"50"},"Ticks"),o.default.createElement(m.TableHeaderColumn,{dataField:"stars",dataSort:!0,dataFormat:this.formatStars.bind(this),dataAlign:"center",width:"70"},"Stars"),o.default.createElement(m.TableHeaderColumn,{dataField:"numImages",dataSort:!0,dataFormat:this.formatNumImages.bind(this),sortFunc:this.sortNumImages.bind(this),dataAlign:"center",width:"50"},o.default.createElement(h.FontAwesomeIcon,{icon:"camera"})),o.default.createElement(m.TableHeaderColumn,{dataField:"numMovies",dataSort:!0,dataFormat:this.formatNumMovies.bind(this),sortFunc:this.sortNumMovies.bind(this),dataAlign:"center",width:"50"},o.default.createElement(h.FontAwesomeIcon,{icon:"video"})),o.default.createElement(m.TableHeaderColumn,{dataField:"distance",dataSort:!0,dataFormat:this.formatDistance.bind(this),sortFunc:this.sortDistance.bind(this),dataAlign:"center",width:"60"},o.default.createElement(h.FontAwesomeIcon,{icon:"plane"}))):o.default.createElement(m.BootstrapTable,{data:this.state.data.problems,trClassName:this.trClassFormat.bind(this),condensed:!0,hover:!0,columnFilter:!1},o.default.createElement(m.TableHeaderColumn,{dataField:"id",isKey:!0,hidden:!0},"id"),o.default.createElement(m.TableHeaderColumn,{dataField:"areaName",dataSort:!0,dataFormat:this.formatAreaName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Area"),o.default.createElement(m.TableHeaderColumn,{dataField:"sectorName",dataSort:!0,dataFormat:this.formatSectorName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Sector"),o.default.createElement(m.TableHeaderColumn,{dataField:"name",dataSort:!0,dataFormat:this.formatName.bind(this),width:"150",filter:{type:"TextFilter",placeholder:"Filter"}},"Name"),o.default.createElement(m.TableHeaderColumn,{dataField:"type",dataFormat:this.formatType.bind(this),dataAlign:"center",width:"70"},"Type"),o.default.createElement(m.TableHeaderColumn,{dataField:"grade",dataSort:!0,dataAlign:"center",width:"70"},"Grade"),o.default.createElement(m.TableHeaderColumn,{dataField:"fa",dataSort:!0,dataFormat:this.formatFa.bind(this),sortFunc:this.sortFa.bind(this),dataAlign:"center",width:"70"},"FA"),o.default.createElement(m.TableHeaderColumn,{dataField:"numTicks",dataSort:!0,dataAlign:"center",width:"50"},"Ticks"),o.default.createElement(m.TableHeaderColumn,{dataField:"stars",dataSort:!0,dataFormat:this.formatStars.bind(this),dataAlign:"center",width:"70"},"Stars"),o.default.createElement(m.TableHeaderColumn,{dataField:"numImages",dataSort:!0,dataFormat:this.formatNumImages.bind(this),sortFunc:this.sortNumImages.bind(this),dataAlign:"center",width:"50"},o.default.createElement(h.FontAwesomeIcon,{icon:"camera"})),o.default.createElement(m.TableHeaderColumn,{dataField:"numMovies",dataSort:!0,dataFormat:this.formatNumMovies.bind(this),sortFunc:this.sortNumMovies.bind(this),dataAlign:"center",width:"50"},o.default.createElement(h.FontAwesomeIcon,{icon:"video"}))),o.default.createElement("div",null,o.default.createElement(s.default,null,o.default.createElement("title",null,this.state.data.metadata.title),o.default.createElement("meta",{name:"description",content:this.state.data.metadata.description})),o.default.createElement(f.Breadcrumb,null,o.default.createElement(u.Link,{to:"/"},"Home")," / ",o.default.createElement("font",{color:"#777"},"Finder [",this.state.data.grade,"] (problems: ",this.state.data.problems.length,")")),t,a)}}]),t}();b.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(b)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=p(r),l=a(2),i=a(1),s=p(a(7)),u=a(4),c=a(3),d=p(a(46)),f=p(a(47)),m=p(a(48)),h=a(5);function p(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;if(!this.state.data){var t=this.props.cookies.get("access_token");this.props.fetchInitialData(t).then(function(t){return e.setState(function(){return{data:t}})})}}},{key:"render",value:function(){if(!this.state||!this.state.data)return o.default.createElement("center",null,o.default.createElement(h.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));var e=this.state.data.fas.map(function(e,t){return o.default.createElement("p",{key:t},o.default.createElement(u.Link,{to:"/problem/"+e.idProblem},e.problem)," ",e.grade,o.default.createElement("br",null),o.default.createElement("small",{style:{color:"#777"}},o.default.createElement(u.Link,{to:"/area/"+e.idArea,style:{color:"#777"}},e.area)," / ",o.default.createElement(u.Link,{to:"/sector/"+e.idSector,style:{color:"#777"}},e.sector)," ",e.date))}),t=this.state.data.ascents.map(function(e,t){return o.default.createElement("p",{key:t},o.default.createElement(u.Link,{to:"/problem/"+e.idProblem},e.problem)," ",e.grade,o.default.createElement("br",null),o.default.createElement("small",{style:{color:"#777"}},o.default.createElement(u.Link,{to:"/user/"+e.idUser,style:{color:"#777"}},e.user)," ",e.date))}),a=this.state.data.medias.map(function(e,t){var a="image"===e.type?o.default.createElement(h.FontAwesomeIcon,{icon:"camera"}):o.default.createElement(h.FontAwesomeIcon,{icon:"video"});return o.default.createElement("p",{key:t},o.default.createElement(u.Link,{to:"/problem/"+e.idProblem},e.problem)," ",o.default.createElement("small",null,e.grade)," ",a)}),n=this.state.data.comments.map(function(e,t){return o.default.createElement("p",{key:t},o.default.createElement("small",null,e.date)," ",o.default.createElement(u.Link,{to:"/problem/"+e.idProblem},e.problem))});return o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("title",null,this.state.data.metadata.title),o.default.createElement("meta",{name:"description",content:this.state.data.metadata.description})),o.default.createElement(c.Grid,null,o.default.createElement(c.Row,null,o.default.createElement(c.Well,{style:{textAlign:"center"}},"Total: ",this.state.data.numProblems," (",this.state.data.numProblemsWithCoordinates," with coordinates",this.state.data.numProblemsWithTopo>0?", "+this.state.data.numProblemsWithTopo+" on topo":"",") | Public ascents: ",this.state.data.numTicks," | Images: ",this.state.data.numImages," | Ascents on video: ",this.state.data.numMovies)),o.default.createElement(c.Row,null,o.default.createElement(c.Col,{xs:8,md:9,style:{paddingLeft:"3px",paddingRight:"3px"}},o.default.createElement(f.default,{data:this.state.data.randomMedia})),o.default.createElement(c.Col,{xs:4,md:3,style:{paddingLeft:"3px",paddingRight:"3px"}},o.default.createElement(m.default,{showLogoPlay:this.state.data.showLogoPlay,showLogoSis:this.state.data.showLogoSis,showLogoBrv:this.state.data.showLogoBrv}))),o.default.createElement(c.Row,null,o.default.createElement(c.Col,{xs:6,lg:3,style:{paddingLeft:"3px",paddingRight:"3px"}},o.default.createElement(d.default,{title:"Newest",data:e})),o.default.createElement(c.Col,{xs:6,lg:3,style:{paddingLeft:"3px",paddingRight:"3px"}},o.default.createElement(d.default,{title:"Latest ascents",data:t})),o.default.createElement(c.Clearfix,{visibleXsBlock:!0}),o.default.createElement(c.Col,{xs:6,lg:3,style:{paddingLeft:"3px",paddingRight:"3px"}},o.default.createElement(d.default,{title:"Newest media",data:a})),o.default.createElement(c.Col,{xs:6,lg:3,style:{paddingLeft:"3px",paddingRight:"3px"}},o.default.createElement(d.default,{title:"Latest comments",data:n})))))}}]),t}();b.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(b)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r);var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={showAll:!1,btnLabel:"More"},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"handleOnClick",value:function(e){e.preventDefault(),!0===this.state.showAll?this.setState({showAll:!1,btnLabel:"More"}):this.setState({showAll:!0,btnLabel:"Less"})}},{key:"render",value:function(){var e=!0===this.state.showAll?this.props.data:this.props.data.map(function(e,t){if(t<10)return e});return o.default.createElement("div",{style:{backgroundColor:"#FFF",position:"relative",padding:"45px 15px 15px",borderColor:"#e3e3e3",borderStyle:"solid",borderWidth:"1px",borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:"4px"}},e,o.default.createElement("div",{style:{position:"absolute",top:"15px",left:"15px",fontSize:"12px",fontWeight:"700",color:"#959595",textTransform:"uppercase",letterSpacing:"1px"}},this.props.title),o.default.createElement("a",{style:{float:"right",display:"inline-block",position:"relative",right:"-16px",top:"15px",background:"#FFF",borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",border:"1px solid #e3e3e3",borderTop:"none",padding:"4px 8px",marginBottom:"20px"},href:"#",onClick:this.handleOnClick.bind(this)},this.state.btnLabel))}}]),t}();t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(4),i=a(3),s=a(6);var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=null;return this.props&&this.props.data?(e=this.props.data.inPhoto?o.default.createElement("i",null,"Photographer: ",o.default.createElement(l.Link,{to:"/user/"+this.props.data.idCreator},this.props.data.creator),", in photo: ",this.props.data.inPhoto):o.default.createElement("i",null,"Photographer: ",o.default.createElement(l.Link,{to:"/user/"+this.props.data.idCreator},this.props.data.creator)),o.default.createElement(i.Well,{style:{marginBottom:"15px",textAlign:"center"}},o.default.createElement("h4",null,o.default.createElement(l.Link,{to:"/problem/"+this.props.data.idProblem},this.props.data.problem)," ",this.props.data.grade),o.default.createElement(l.Link,{to:"/problem/"+this.props.data.idProblem},o.default.createElement("img",{style:{maxWidth:"100%"},src:(0,s.getImageUrl)(this.props.data.idMedia,480),alt:this.props.data.problem})),o.default.createElement("br",null),e)):o.default.createElement(i.Well,{style:{marginBottom:"15px",textAlign:"center"}},"No data")}}]),t}();t.default=u},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r);a(4);var l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){return o.default.createElement("div",null,this.props.showLogoPlay&&o.default.createElement("a",{href:"https://play.google.com/store/apps/details?id=org.jossi.android.bouldering&pcampaignid=MKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1",rel:"noopener",target:"_blank"},o.default.createElement("img",{style:{maxWidth:"100%"},alt:"Get it on Google Play",src:"https://play.google.com/intl/en_us/badges/images/generic/en_badge_web_generic.png"})),this.props.showLogoSis&&o.default.createElement("a",{href:"http://sissportssenter.no/",rel:"noopener",target:"_blank"},o.default.createElement("img",{style:{marginBottom:"10px",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px",paddingLeft:"10px",paddingRight:"10px",maxWidth:"100%",backgroundColor:"#00A0E0"},src:"/png/sis-sportssenter.png",alt:"SiS Sportssenter"})),this.props.showLogoBrv&&o.default.createElement("a",{href:"http://brv.no/",rel:"noopener",target:"_blank"},o.default.createElement("img",{style:{marginBottom:"10px",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px",paddingLeft:"10px",paddingRight:"10px",maxWidth:"100%",backgroundColor:"#FFFFFF"},src:"/png/brv.png",alt:"Bratte Rogalands venner"})))}}]),t}();t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=(function(e){e&&e.__esModule}(r),a(2)),l=a(1),i=a(15);var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this.props.cookies;(0,i.login)(e)}},{key:"render",value:function(){return null}}]),t}();s.propTypes={cookies:(0,o.instanceOf)(l.Cookies).isRequired},t.default=(0,l.withCookies)(s)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(2),i=a(1),s=a(3),u=a(15);var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this.props.cookies;(0,u.logout)(e),window.location.href="/"}},{key:"render",value:function(){return o.default.createElement(s.Well,null,"Logging out, please wait")}}]),t}();c.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(c)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=y(r),l=a(2),i=a(1),s=y(a(7)),u=a(4),c=y(a(10)),d=y(a(13)),f=a(9),m=a(3),h=y(a(20)),p=y(a(52)),b=a(5);function y(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n,tabIndex:1,showTickModal:!1,showCommentModal:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.problemId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.problemId!==this.props.match.params.problemId&&this.refresh(this.props.match.params.problemId)}},{key:"handleTabsSelection",value:function(e){this.setState({tabIndex:e})}},{key:"intersperse",value:function(e,t){return 0===e.length?[]:e.slice(1).reduce(function(e,a,n){return e.concat([t,a])},[e[0]])}},{key:"closeTickModal",value:function(e){this.setState({showTickModal:!1}),this.refresh(this.props.match.params.problemId)}},{key:"openTickModal",value:function(e){this.setState({showTickModal:!0})}},{key:"closeCommentModal",value:function(e){this.setState({showCommentModal:!1}),this.refresh(this.props.match.params.problemId)}},{key:"openCommentModal",value:function(e){this.setState({showCommentModal:!0})}},{key:"onRemoveMedia",value:function(e){var t=this.state.data.media.filter(function(t){return t.id!=e});this.setState({media:t})}},{key:"render",value:function(){var e=this.state.data;if(!e)return o.default.createElement("center",null,o.default.createElement(b.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));var t=[];e.lat>0&&e.lng>0&&t.push({lat:e.lat,lng:e.lng,title:e.name+" ["+e.grade+"]",label:e.name.charAt(0),url:"/problem/"+e.id,icon:{url:e.ticks&&e.ticks.filter(function(e){return e.writable}).length>0?"https://mt.google.com/vt/icon?name=icons/spotlight/spotlight-waypoint-a.png":"https://mt.google.com/vt/icon?name=icons/spotlight/spotlight-waypoint-b.png",labelOriginX:11,labelOriginY:13}}),e.sectorLat>0&&e.sectorLng>0&&t.push({lat:e.sectorLat,lng:e.sectorLng,title:"Parking",labelContent:e.sectorName,icon:{url:"https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png",scaledSizeW:32,scaledSizeH:32},url:"/sector/"+e.sectorId});var a=t.length>0?o.default.createElement(c.default,{markers:t,defaultCenter:{lat:t[0].lat,lng:t[0].lng},defaultZoom:16}):null,n=e.media&&e.media.length>0?o.default.createElement(d.default,{isAdmin:this.state.data.metadata.isAdmin,alt:e.name+" "+e.grade+" ("+e.areaName+" - "+e.sectorName+")",media:e.media,showThumbnails:!1,removeMedia:this.onRemoveMedia.bind(this)}):null,r=null;a&&n?r=o.default.createElement(m.Tabs,{activeKey:this.state.tabIndex,animation:!1,onSelect:this.handleTabsSelection.bind(this),id:"problem_tab",unmountOnExit:!0},o.default.createElement(m.Tab,{eventKey:1,title:"Media"},1==this.state.tabIndex&&n),o.default.createElement(m.Tab,{eventKey:2,title:"Map"},2==this.state.tabIndex&&a)):a?r=a:n&&(r=n);var l=e.fa?e.fa.map(function(e,t){return o.default.createElement(u.Link,{key:t,to:"/user/"+e.id},e.firstname," ",e.surname)}):[];l=this.intersperse(l,", ");var i=null;if(e.ticks){var y=e.ticks.map(function(e,t){var a=e.writable?"success":"",n=null;return.5===e.stars?n=o.default.createElement(b.FontAwesomeIcon,{icon:"star-half"}):1===e.stars?n=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:2},o.default.createElement(b.FontAwesomeIcon,{icon:"star"})):1.5===e.stars?n=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:3},o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star-half"})):2===e.stars?n=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:4},o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star"})):2.5===e.stars?n=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:5},o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star-half"})):3===e.stars&&(n=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:6},o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star"}))),n&&(n=o.default.createElement(m.OverlayTrigger,{placement:"top",overlay:o.default.createElement(m.Popover,{id:0,title:"Guidelines"},o.default.createElement(b.FontAwesomeIcon,{icon:"star"})," Nice",o.default.createElement("br",null),o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star"})," Very nice",o.default.createElement("br",null),o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star"}),o.default.createElement(b.FontAwesomeIcon,{icon:"star"})," Fantastic!")},n)),o.default.createElement("tr",{className:a,key:t},o.default.createElement("td",null,e.date),o.default.createElement("td",null,o.default.createElement(u.Link,{to:"/user/"+e.idUser},e.name)),o.default.createElement("td",null,e.suggestedGrade),o.default.createElement("td",null,e.comment),o.default.createElement("td",null,n))});i=o.default.createElement(m.Table,{striped:!0,condensed:!0,hover:!0},o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("th",null,"When"),o.default.createElement("th",null,"Name"),o.default.createElement("th",null,"Grade"),o.default.createElement("th",null,"Comment"),o.default.createElement("th",null,"Stars"))),o.default.createElement("tbody",null,y))}var g=null;if(e.comments){var v=e.comments.map(function(e,t){var a=o.default.createElement("span",null,o.default.createElement(u.Link,{to:"/user/"+e.idUser},e.name)," ",o.default.createElement("small",null,o.default.createElement("i",null,e.date)));return o.default.createElement(m.Panel,{key:t},o.default.createElement(m.Panel.Heading,null,a),o.default.createElement(m.Panel.Body,null,e.message))});g=o.default.createElement("span",null,v)}var E=null;if(e.sections){var w=e.sections.map(function(e,t){return o.default.createElement("tr",{key:t},o.default.createElement("td",null,e.nr),o.default.createElement("td",null,e.grade),o.default.createElement("td",null,e.description))});E=o.default.createElement("span",null,o.default.createElement("strong",null,"Sections:"),o.default.createElement("br",null),o.default.createElement(m.Table,{striped:!0,bordered:!0,condensed:!0,hover:!0},o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("td",null,"#"),o.default.createElement("td",null,"Grade"),o.default.createElement("td",null,"Description"))),o.default.createElement("tbody",null,w)))}var k=null;e.metadata&&e.metadata.isAuthenticated&&(k=o.default.createElement("div",{style:{float:"right"}},o.default.createElement(m.ButtonGroup,null,o.default.createElement(m.OverlayTrigger,{placement:"top",overlay:o.default.createElement(m.Tooltip,{id:-1},"Tick problem")},o.default.createElement(m.Button,{bsStyle:"primary",bsSize:"xsmall",onClick:this.openTickModal.bind(this)},"Tick")),o.default.createElement(m.OverlayTrigger,{placement:"top",overlay:o.default.createElement(m.Tooltip,{id:-2},"Add comment")},o.default.createElement(m.Button,{bsStyle:"primary",bsSize:"xsmall",onClick:this.openCommentModal.bind(this)},o.default.createElement(b.FontAwesomeIcon,{icon:"comment",inverse:!0}))),e.metadata.isAdmin?o.default.createElement(m.OverlayTrigger,{placement:"top",overlay:o.default.createElement(m.Tooltip,{id:e.id},"Edit problem")},o.default.createElement(f.LinkContainer,{to:{pathname:"/problem/edit/"+e.id,query:{idSector:e.sectorId,lat:e.sectorLat,lng:e.sectorLng}}},o.default.createElement(m.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(b.FontAwesomeIcon,{icon:"edit",inverse:!0})))):o.default.createElement(m.OverlayTrigger,{placement:"top",overlay:o.default.createElement(m.Tooltip,{id:e.id},"Add image(s)")},o.default.createElement(f.LinkContainer,{to:{pathname:"/problem/edit/media/"+e.id}},o.default.createElement(m.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(b.FontAwesomeIcon,{icon:"image",inverse:!0})))))));var C=null;if(e.ticks){var S=e.ticks.filter(function(e){return e.writable});S&&S.length>0&&(C=o.default.createElement(h.default,{idTick:S[0].id,idProblem:e.id,date:S[0].date,comment:S[0].comment,grade:S[0].suggestedGrade,grades:e.metadata.grades,stars:S[0].stars,show:this.state.showTickModal,onHide:this.closeTickModal.bind(this)}))}return C||(C=o.default.createElement(h.default,{idTick:-1,idProblem:e.id,grade:e.originalGrade,grades:e.metadata.grades,show:this.state.showTickModal,onHide:this.closeTickModal.bind(this)})),o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(e.metadata.jsonLd)}}),o.default.createElement("title",null,e.metadata.title),o.default.createElement("meta",{name:"description",content:e.metadata.description})),C,o.default.createElement(p.default,{idProblem:e.id,show:this.state.showCommentModal,onHide:this.closeCommentModal.bind(this)}),o.default.createElement(m.Breadcrumb,null,k,o.default.createElement(u.Link,{to:"/"},"Home")," / ",o.default.createElement(u.Link,{to:"/browse"},"Browse")," / ",o.default.createElement(u.Link,{to:"/area/"+e.areaId},e.areaName)," ",1===e.areaVisibility&&o.default.createElement(b.FontAwesomeIcon,{icon:"lock"}),2===e.areaVisibility&&o.default.createElement(b.FontAwesomeIcon,{icon:"user-secret"})," / ",o.default.createElement(u.Link,{to:"/sector/"+e.sectorId},e.sectorName)," ",1===e.sectorVisibility&&o.default.createElement(b.FontAwesomeIcon,{icon:"lock"}),2===e.sectorVisibility&&o.default.createElement(b.FontAwesomeIcon,{icon:"user-secret"})," / ",e.nr," ",o.default.createElement("font",{color:"#777"},e.name)," ",e.grade," ",1===e.visibility&&o.default.createElement(b.FontAwesomeIcon,{icon:"lock"}),2===e.visibility&&o.default.createElement(b.FontAwesomeIcon,{icon:"user-secret"})),r,o.default.createElement(m.Well,{bsSize:"small"},!e.metadata.isBouldering&&o.default.createElement("span",null,o.default.createElement("strong",null,"Type:")," ",e.t.type+" - "+e.t.subType,o.default.createElement("br",null)),o.default.createElement("strong",null,"Comment:")," ",e.comment,o.default.createElement("br",null),o.default.createElement("strong",null,"FA:")," ",l,o.default.createElement("br",null),o.default.createElement("strong",null,"FA date:")," ",e.faDateHr,o.default.createElement("br",null),o.default.createElement("strong",null,"Original grade:")," ",e.originalGrade,o.default.createElement("br",null),e.sectorLat>0&&e.sectorLng>0&&o.default.createElement("span",null,o.default.createElement("a",{href:"http://maps.google.com/maps?q=loc:"+e.sectorLat+","+e.sectorLng+"&navigate=yes",rel:"noopener",target:"_blank"},"Start navigation"),o.default.createElement("br",null)),E),i,g)}}]),t}();g.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(g)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(2),i=a(1),s=a(3),u=a(6);var c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"refresh",value:function(e){this.setState({idProblem:e.idProblem,comment:""})}},{key:"componentDidMount",value:function(){this.refresh(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.refresh(e)}},{key:"onCommentChanged",value:function(e){this.setState({comment:e.target.value})}},{key:"save",value:function(e){var t=this;if(this.state.comment){var a=this.props.cookies.get("access_token");(0,u.postComment)(a,this.state.idProblem,this.state.comment).then(function(e){t.props.onHide()}).catch(function(e){console.warn(e),alert(e.toString())})}}},{key:"render",value:function(){return o.default.createElement(s.Modal,{show:this.props.show,onHide:this.props.onHide.bind(this)},o.default.createElement(s.Modal.Header,{closeButton:!0},o.default.createElement(s.Modal.Title,null,"Add comment")),o.default.createElement(s.Modal.Body,null,o.default.createElement(s.FormGroup,{controlId:"formControlsTextArea"},o.default.createElement(s.ControlLabel,null,"Comment"),o.default.createElement(s.FormControl,{style:{height:"100px"},componentClass:"textarea",placeholder:"Comment",value:this.state&&this.state.comment,onChange:this.onCommentChanged.bind(this)}))),o.default.createElement(s.Modal.Footer,null,o.default.createElement(s.ButtonGroup,null,o.default.createElement(s.Button,{onClick:this.save.bind(this),bsStyle:"success"},"Save"),o.default.createElement(s.Button,{onClick:this.props.onHide.bind(this)},"Close"))))}}]),t}();c.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(c)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=g(r),l=a(2),i=a(1),s=g(a(7)),u=(a(4),a(8)),c=a(3),d=a(11),f=g(a(54)),m=g(a(56)),h=g(a(12)),p=g(a(21)),b=a(5),y=a(6);function g(e){return e&&e.__esModule?e:{default:e}}var v=(0,d.withScriptjs)((0,d.withGoogleMap)(function(e){return o.default.createElement(d.GoogleMap,{defaultZoom:e.defaultZoom,defaultCenter:e.defaultCenter,defaultMapTypeId:google.maps.MapTypeId.TERRAIN,onClick:e.onClick.bind(void 0)},e.markers)})),E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.problemId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.problemId!==this.props.match.params.problemId&&this.refresh(this.props.match.params.problemId)}},{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"onNameChanged",value:function(e){var t=this.state.data;t.name=e.target.value,this.setState({data:t})}},{key:"onNrChanged",value:function(e){var t=this.state.data;t.nr=parseInt(e.target.value),this.setState({data:t})}},{key:"onLatChanged",value:function(e){var t=this.state.data;t.lat=parseFloat(e.target.value),this.setState({data:t})}},{key:"onLngChanged",value:function(e){var t=this.state.data;t.lng=parseFloat(e.target.value),this.setState({data:t})}},{key:"onVisibilityChanged",value:function(e,t){var a=this.state.data;a.visibility=e,this.setState({data:a})}},{key:"onCommentChanged",value:function(e){var t=this.state.data;t.comment=e.target.value,this.setState({data:t})}},{key:"onFaDateChanged",value:function(e){var t=this.state.data;t.faDate=e,this.setState({data:t})}},{key:"onOriginalGradeChanged",value:function(e,t){var a=this.state.data;a.originalGrade=e,this.setState({data:a})}},{key:"onTypeIdChanged",value:function(e,t){var a=this.state.data;a.typeId=e,this.setState({data:a})}},{key:"onNewMediaChanged",value:function(e){var t=this.state.data;t.newMedia=e,this.setState({data:t})}},{key:"save",value:function(e){var t=this;e.preventDefault(),this.setState({isSaving:!0});var a=this.state.data,n=this.props.cookies.get("access_token");(0,y.postProblem)(n,this.props.location.query.idSector,a.id,a.visibility,a.name,a.comment,a.originalGrade,a.fa,a.faDate,a.nr,a.typeId?a.metadata.types.find(function(e){return e.id===a.typeId}):a.metadata.types[0],a.lat,a.lng,a.sections,a.newMedia).then(function(e){t.setState({pushUrl:"/problem/"+e.id})}).catch(function(e){console.warn(e),t.setState({error:e})})}},{key:"onMapClick",value:function(e){var t=this.state.data;t.lat=e.latLng.lat(),t.lng=e.latLng.lng(),this.setState({data:t})}},{key:"onUsersUpdated",value:function(e){var t=this.state.data;t.fa=e.map(function(e){return{id:"string"==typeof e.value||e.value instanceof String?-1:e.value,firstname:e.label,surname:null}}),this.setState({data:t})}},{key:"onSectionsUpdated",value:function(e){var t=this.state.data;t.sections=e,this.setState({data:t})}},{key:"onCancel",value:function(){window.history.back()}},{key:"render",value:function(){var e=this,t=this.state.data;if(this.state.pushUrl)return o.default.createElement(u.Redirect,{to:this.state.pushUrl,push:!0});if(this.state.pushUrl)return o.default.createElement(u.Redirect,{to:this.state.pushUrl,push:!0});if(!(this.props&&this.props.match&&this.props.match.params&&this.props.match.params.problemId&&this.props.location&&this.props.location.query&&this.props.location.query.idSector))return o.default.createElement("span",null,o.default.createElement("h3",null,"Invalid action..."));if(!t)return o.default.createElement("center",null,o.default.createElement(b.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));t.metadata.isAdmin||this.setState({pushUrl:"/login",error:null});var a=new Date;a.setDate(a.getDate()-1);var n="Visible for everyone";1===t.visibility?n="Only visible for administrators":2===t.visibility&&(n="Only visible for super administrators");var r,l,i=t.typeId?t.metadata.types.find(function(e){return e.id===t.typeId}):t.metadata.types[0];0!=t.lat&&0!=t.lng?(r={lat:t.lat,lng:t.lng},l=15):this.props.location.query.lat&&parseFloat(this.props.location.query.lat)>0?(r={lat:parseFloat(this.props.location.query.lat),lng:parseFloat(this.props.location.query.lng)},l=14):(r=t.metadata.defaultCenter,l=t.metadata.defaultZoom);var g=null;return t.metadata.isBouldering||(g=o.default.createElement(c.FormGroup,{controlId:"formControlsSections"},o.default.createElement(c.ControlLabel,null,"Section(s)"),o.default.createElement("br",null),o.default.createElement(m.default,{sections:t.sections,grades:t.metadata.grades,onSectionsUpdated:this.onSectionsUpdated.bind(this)}))),o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("title",null,t.metadata.title)),o.default.createElement(c.Well,null,o.default.createElement("form",{onSubmit:this.save.bind(this)},o.default.createElement(c.FormGroup,{controlId:"formControlsName"},o.default.createElement(c.ControlLabel,null,"Problem name"),o.default.createElement(c.FormControl,{type:"text",value:t.name,placeholder:"Enter name",onChange:this.onNameChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsFaDate"},o.default.createElement(c.ControlLabel,null,"FA date (yyyy-mm-dd)"),o.default.createElement("br",null),o.default.createElement(p.default,{format:"YYYY-MM-DD",computableFormat:"YYYY-MM-DD",date:t.faDate,onChange:this.onFaDateChanged.bind(this)}),o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.Button,{onClick:this.onFaDateChanged.bind(this,(0,y.convertFromDateToString)(a))},"Yesterday"),o.default.createElement(c.Button,{onClick:this.onFaDateChanged.bind(this,(0,y.convertFromDateToString)(new Date))},"Today"))),o.default.createElement(c.FormGroup,{controlId:"formControlsTypeId"},o.default.createElement(c.ControlLabel,null,"Type"),o.default.createElement("br",null),o.default.createElement(c.DropdownButton,{title:i.type+(i.subType?" - "+i.subType:""),id:"bg-nested-dropdown"},t.metadata.types.map(function(t,a){return o.default.createElement(c.MenuItem,{key:a,eventKey:a,onSelect:e.onTypeIdChanged.bind(e,t.id)},t.type," ",t.subType?" - "+t.subType:"")}))),o.default.createElement(c.FormGroup,{controlId:"formControlsGrade"},o.default.createElement(c.ControlLabel,null,"Grade"),o.default.createElement("br",null),o.default.createElement(c.DropdownButton,{title:t.originalGrade,id:"bg-nested-dropdown"},t.metadata.grades.map(function(t,a){return o.default.createElement(c.MenuItem,{key:a,eventKey:a,onSelect:e.onOriginalGradeChanged.bind(e,t.grade)},t.grade)}))),o.default.createElement(c.FormGroup,{controlId:"formControlsFA"},o.default.createElement(c.ControlLabel,null,"FA"),o.default.createElement("br",null),o.default.createElement(f.default,{users:t.fa?t.fa.map(function(e){return{value:e.id,label:e.firstname+" "+e.surname}}):[],onUsersUpdated:this.onUsersUpdated.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsVisibility"},o.default.createElement(c.ControlLabel,null,"Visibility"),o.default.createElement("br",null),o.default.createElement(c.DropdownButton,{title:n,id:"bg-nested-dropdown"},o.default.createElement(c.MenuItem,{eventKey:"0",onSelect:this.onVisibilityChanged.bind(this,0)},"Visible for everyone"),o.default.createElement(c.MenuItem,{eventKey:"1",onSelect:this.onVisibilityChanged.bind(this,1)},"Only visible for administrators"),t.metadata.isSuperAdmin&&o.default.createElement(c.MenuItem,{eventKey:"2",onSelect:this.onVisibilityChanged.bind(this,2)},"Only visible for super administrators"))),o.default.createElement(c.FormGroup,{controlId:"formControlsSectorNr"},o.default.createElement(c.ControlLabel,null,"Sector number"),o.default.createElement(c.FormControl,{type:"text",value:t.nr,placeholder:"Enter sector number",onChange:this.onNrChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsComment"},o.default.createElement(c.ControlLabel,null,"Comment"),o.default.createElement(c.FormControl,{style:{height:"100px"},componentClass:"textarea",placeholder:"Enter comment",value:t.comment,onChange:this.onCommentChanged.bind(this)})),g,o.default.createElement(c.FormGroup,{controlId:"formControlsMedia"},o.default.createElement(h.default,{onMediaChanged:this.onNewMediaChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsMap"},o.default.createElement(c.ControlLabel,null,"Click to mark problem on map"),o.default.createElement("br",null),o.default.createElement("section",{style:{height:"600px"}},o.default.createElement(v,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCpaVd5518yMB-oiIyP5JnTVWMfrOv4sAI&v=3.exp",loadingElement:o.default.createElement("div",{style:{height:"100%"}}),containerElement:o.default.createElement("div",{style:{height:"100%"}}),mapElement:o.default.createElement("div",{style:{height:"100%"}}),defaultZoom:l,defaultCenter:r,onClick:this.onMapClick.bind(this),markers:0!=t.lat&&0!=t.lng?o.default.createElement(d.Marker,{position:{lat:t.lat,lng:t.lng}}):""})),o.default.createElement(c.ControlLabel,null,"Latitude"),o.default.createElement(c.FormControl,{type:"text",value:t.lat,placeholder:"Latitude",onChange:this.onLatChanged.bind(this)}),o.default.createElement(c.ControlLabel,null,"Longitude"),o.default.createElement(c.FormControl,{type:"text",value:t.lng,placeholder:"Longitude",onChange:this.onLngChanged.bind(this)})),o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.Button,{bsStyle:"danger",onClick:this.onCancel.bind(this)},"Cancel"),o.default.createElement(c.Button,{type:"submit",bsStyle:"success",disabled:this.state.isSaving},this.state.isSaving?"Saving...":"Save problem")))))}}]),t}();E.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(E)},function(e,t,a){"use strict";var n=u(a(0)),r=u(a(22)),o=u(a(2)),l=a(1),i=u(a(55)),s=a(6);function u(e){return e&&e.__esModule?e:{default:e}}var c=(0,r.default)({displayName:"UserSelector",propTypes:{label:o.default.string},getInitialState:function(){var e=this,t=this.props.cookies.get("access_token");return(0,s.getUserSearch)(t,"").then(function(t){return e.setState({options:t.map(function(e){return{value:e.id,label:e.name}})})}),{multiValue:this.props.users,options:[]}},handleOnChange:function(e){this.props.onUsersUpdated(e),this.setState({multiValue:e})},isValidNewOption:function(e){return 0==this.state.options.filter(function(t){return e.toLowerCase()===t.label.toLowerCase()}).length},render:function(){return n.default.createElement("div",{style:{position:"relative",width:"100%"}},n.default.createElement("div",{style:{width:"100%"}},n.default.createElement(i.default,{isMulti:!0,options:this.state.options,onChange:this.handleOnChange,isValidNewOption:this.isValidNewOption,value:this.state.multiValue})))}});e.exports=(0,l.withCookies)(c)},function(e,t){e.exports=require("react-select/lib/Creatable")},function(e,t,a){"use strict";var n=i(a(0)),r=i(a(22)),o=i(a(2)),l=a(3);function i(e){return e&&e.__esModule?e:{default:e}}var s=(0,r.default)({displayName:"ProblemSection",propTypes:{label:o.default.string},getInitialState:function(){return{sections:this.props.sections,grades:this.props.grades}},onNumberOfSectionsChange:function(e){var t=null;if(e>1){for(t=this.state.sections?this.state.sections:[];e>t.length;)t.push({id:-1*t.length,nr:t.length+1,grade:"n/a",description:null});for(;e<t.length;)t.pop()}this.props.onSectionsUpdated(t),this.setState({sections:t})},onNrChanged:function(e,t){var a=this.state.sections;a.find(function(t){return t.id===e}).nr=t.target.value,this.props.onSectionsUpdated(a),this.setState({sections:a})},onGradeChanged:function(e,t){var a=this.state.sections;a.find(function(t){return t.id===e}).grade=t,this.props.onSectionsUpdated(a),this.setState({sections:a})},onDescriptionChanged:function(e,t){var a=this.state.sections;a.find(function(t){return t.id===e}).description=t.target.value,this.props.onSectionsUpdated(a),this.setState({sections:a})},render:function(){var e=this,t=this.state.sections&&this.state.sections.length>1&&this.state.sections.map(function(t,a){return n.default.createElement(l.Form,{componentClass:"fieldset",inline:!0,key:a},n.default.createElement(l.FormGroup,{controlId:"formNr"},n.default.createElement(l.FormControl,{type:"number",value:t.nr,onChange:e.onNrChanged.bind(e,t.id),style:{width:"50px"}}))," ",n.default.createElement(l.FormGroup,{controlId:"formGrade"},n.default.createElement(l.DropdownButton,{title:t.grade,id:"bg-nested-dropdown"},e.state.grades.map(function(a,r){return n.default.createElement(l.MenuItem,{key:r,eventKey:r,onSelect:e.onGradeChanged.bind(e,t.id,a.grade)},a.grade)})))," ",n.default.createElement(l.FormGroup,{controlId:"formDescription"},n.default.createElement(l.FormControl,{type:"text",value:t.description?t.description:"",onChange:e.onDescriptionChanged.bind(e,t.id),style:{width:"500px"}})))});return n.default.createElement(l.Well,null,n.default.createElement(l.FormGroup,{controlId:"formControlsNumSections"},n.default.createElement(l.DropdownButton,{title:this.state.sections?this.state.sections.length:1,id:"bg-nested-dropdown"},n.default.createElement(l.MenuItem,{key:1,eventKey:1,onSelect:this.onNumberOfSectionsChange.bind(this,1)},"1"),n.default.createElement(l.MenuItem,{key:2,eventKey:2,onSelect:this.onNumberOfSectionsChange.bind(this,2)},"2"),n.default.createElement(l.MenuItem,{key:3,eventKey:3,onSelect:this.onNumberOfSectionsChange.bind(this,3)},"3"),n.default.createElement(l.MenuItem,{key:4,eventKey:4,onSelect:this.onNumberOfSectionsChange.bind(this,4)},"4"),n.default.createElement(l.MenuItem,{key:5,eventKey:5,onSelect:this.onNumberOfSectionsChange.bind(this,5)},"5"),n.default.createElement(l.MenuItem,{key:6,eventKey:6,onSelect:this.onNumberOfSectionsChange.bind(this,6)},"6"),n.default.createElement(l.MenuItem,{key:7,eventKey:7,onSelect:this.onNumberOfSectionsChange.bind(this,7)},"7"),n.default.createElement(l.MenuItem,{key:8,eventKey:8,onSelect:this.onNumberOfSectionsChange.bind(this,8)},"8"),n.default.createElement(l.MenuItem,{key:9,eventKey:9,onSelect:this.onNumberOfSectionsChange.bind(this,9)},"9"),n.default.createElement(l.MenuItem,{key:10,eventKey:10,onSelect:this.onNumberOfSectionsChange.bind(this,10)},"10"),n.default.createElement(l.MenuItem,{key:11,eventKey:11,onSelect:this.onNumberOfSectionsChange.bind(this,11)},"11"),n.default.createElement(l.MenuItem,{key:12,eventKey:12,onSelect:this.onNumberOfSectionsChange.bind(this,12)},"12"),n.default.createElement(l.MenuItem,{key:13,eventKey:13,onSelect:this.onNumberOfSectionsChange.bind(this,13)},"13"),n.default.createElement(l.MenuItem,{key:14,eventKey:14,onSelect:this.onNumberOfSectionsChange.bind(this,14)},"14"),n.default.createElement(l.MenuItem,{key:15,eventKey:15,onSelect:this.onNumberOfSectionsChange.bind(this,15)},"15"),n.default.createElement(l.MenuItem,{key:16,eventKey:16,onSelect:this.onNumberOfSectionsChange.bind(this,16)},"16"),n.default.createElement(l.MenuItem,{key:17,eventKey:17,onSelect:this.onNumberOfSectionsChange.bind(this,17)},"17"),n.default.createElement(l.MenuItem,{key:18,eventKey:18,onSelect:this.onNumberOfSectionsChange.bind(this,18)},"18"),n.default.createElement(l.MenuItem,{key:19,eventKey:19,onSelect:this.onNumberOfSectionsChange.bind(this,19)},"19"),n.default.createElement(l.MenuItem,{key:20,eventKey:20,onSelect:this.onNumberOfSectionsChange.bind(this,20)},"20"))),t)}});e.exports=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=m(r),l=a(2),i=a(1),s=(a(4),a(8)),u=a(3),c=m(a(12)),d=a(5),f=a(6);function m(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){this.refresh(this.props.match.params.problemId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.problemId!==this.props.match.params.problemId&&this.refresh(this.props.match.params.problemId)}},{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");(0,f.getProblem)(a,e).then(function(e){return t.setState({id:e.id,isAuthenticated:e.metadata.isAuthenticated})})}},{key:"onNewMediaChanged",value:function(e){this.setState({newMedia:e})}},{key:"save",value:function(e){var t=this;e.preventDefault(),this.setState({isSaving:!0});var a=this.props.cookies.get("access_token");(0,f.postProblemMedia)(a,this.state.id,this.state.newMedia).then(function(e){t.setState({pushUrl:"/problem/"+e.id})}).catch(function(e){console.warn(e)})}},{key:"onCancel",value:function(){window.history.back()}},{key:"render",value:function(){return this.state&&this.state.id?this.state.pushUrl?o.default.createElement(s.Redirect,{to:this.state.pushUrl,push:!0}):(this.state.isAuthenticated||this.setState({pushUrl:"/login"}),o.default.createElement("span",null,o.default.createElement(u.Well,null,o.default.createElement("form",{onSubmit:this.save.bind(this)},o.default.createElement(u.FormGroup,{controlId:"formControlsMedia"},o.default.createElement(c.default,{onMediaChanged:this.onNewMediaChanged.bind(this)})),o.default.createElement(u.ButtonGroup,null,o.default.createElement(u.Button,{bsStyle:"danger",onClick:this.onCancel.bind(this)},"Cancel"),o.default.createElement(u.Button,{type:"submit",bsStyle:"success",disabled:this.state.isSaving},this.state.isSaving?"Saving...":"Save")))))):o.default.createElement("center",null,o.default.createElement(d.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}))}}]),t}();h.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(h)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=p(r),l=a(2),i=a(1),s=p(a(7)),u=a(4),c=p(a(10)),d=p(a(13)),f=a(3),m=a(9),h=a(5);function p(e){return e&&e.__esModule?e:{default:e}}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function t(){return b(this,t),y(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return g(t,r.Component),n(t,[{key:"intersperse",value:function(e,t){return 0===e.length?[]:e.slice(1).reduce(function(e,a,n){return e.concat([t,a])},[e[0]])}},{key:"render",value:function(){var e="";if(this.props.problem.comment)if(this.props.problem.comment.length>40){var t=o.default.createElement(f.Tooltip,{id:this.props.problem.id},this.props.problem.comment);e=o.default.createElement(f.OverlayTrigger,{key:this.props.problem.id,placement:"top",overlay:t},o.default.createElement("span",null,this.props.problem.comment.substring(0,40)+"..."))}else e=this.props.problem.comment;var a=this.props.problem.fa?this.props.problem.fa.map(function(e,t){return o.default.createElement(u.Link,{key:t,to:"/user/"+e.id},e.firstname," ",e.surname)}):[];a=this.intersperse(a,", ");var n,r=this.props.problem.ticked?"success":"",l=null;if(.5===this.props.problem.stars?l=o.default.createElement(h.FontAwesomeIcon,{icon:"star-half"}):1===this.props.problem.stars?l=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:2},o.default.createElement(h.FontAwesomeIcon,{icon:"star"})):1.5===this.props.problem.stars?l=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:3},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star-half"})):2===this.props.problem.stars?l=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:4},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"})):2.5===this.props.problem.stars?l=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:5},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star-half"})):3===this.props.problem.stars&&(l=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:6},o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}))),l&&(l=o.default.createElement(f.OverlayTrigger,{placement:"top",overlay:o.default.createElement(f.Popover,{id:0,title:"Guidelines"},o.default.createElement(h.FontAwesomeIcon,{icon:"star"})," Nice",o.default.createElement("br",null),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"})," Very nice",o.default.createElement("br",null),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"}),o.default.createElement(h.FontAwesomeIcon,{icon:"star"})," Fantastic!")},l)),this.state&&this.state.data&&!this.state.data.metadata.isBouldering){var i;switch(this.props.problem.t.id){case 2:i=o.default.createElement("img",{height:"20",src:"/jpg/bolt.jpg"});break;case 3:i=o.default.createElement("img",{height:"20",src:"/jpg/trad.jpg"});break;case 4:i=o.default.createElement("img",{height:"20",src:"/jpg/mixed.jpg"})}n=o.default.createElement("td",null,o.default.createElement(f.OverlayTrigger,{placement:"top",overlay:o.default.createElement(f.Popover,{id:this.props.problem.t.id,title:"Type"},this.props.problem.t.type+" - "+this.props.problem.t.subType)},i))}return o.default.createElement("tr",{className:r},o.default.createElement("td",null,this.props.problem.nr),o.default.createElement("td",null,o.default.createElement(u.Link,{to:"/problem/"+this.props.problem.id},this.props.problem.name)," ",1===this.props.problem.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===this.props.problem.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"})),o.default.createElement("td",null,e),n,o.default.createElement("td",null,this.props.problem.grade),o.default.createElement("td",null,a),o.default.createElement("td",null,this.props.problem.numTicks),o.default.createElement("td",null,l),o.default.createElement("td",null,this.props.problem.numImages),o.default.createElement("td",null,this.props.problem.numMovies),o.default.createElement("td",null,(this.props.problem.lat>0&&this.props.problem.lng>0||this.props.problemsInTopo.indexOf(this.props.problem.id)>=0)&&o.default.createElement(h.FontAwesomeIcon,{icon:"check"})))}}]),t}(),E=function(e){function t(e){b(this,t);var a=y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n,tabIndex:1},a}return g(t,r.Component),n(t,[{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.sectorId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.sectorId!==this.props.match.params.sectorId&&this.refresh(this.props.match.params.sectorId)}},{key:"handleTabsSelection",value:function(e){this.setState({tabIndex:e})}},{key:"onRemoveMedia",value:function(e){var t=this.state.data.media.filter(function(t){return t.id!=e});this.setState({media:t})}},{key:"render",value:function(){var e=this.state.data;if(!e)return o.default.createElement("center",null,o.default.createElement(h.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));var t=[];e.media&&e.media.forEach(function(e){e.svgs&&e.svgs.forEach(function(e){return t.push(e.problemId)})});var a=e.problems.map(function(e,a){return o.default.createElement(v,{problem:e,problemsInTopo:t,key:a})}),n=e.problems.filter(function(e){return 0!=e.lat&&0!=e.lng}).map(function(e){return{lat:e.lat,lng:e.lng,title:e.nr+" - "+e.name+" ["+e.grade+"]",label:e.name.charAt(0),url:"/problem/"+e.id,icon:{url:e.ticked?"https://mt.google.com/vt/icon?name=icons/spotlight/spotlight-waypoint-a.png":"https://mt.google.com/vt/icon?name=icons/spotlight/spotlight-waypoint-b.png",labelOriginX:11,labelOriginY:13}}});e.lat>0&&e.lng>0&&n.push({lat:e.lat,lng:e.lng,title:"Parking",icon:{url:"https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png",scaledSizeW:32,scaledSizeH:32},url:"/sector/"+e.id});var r=e.lat&&e.lat>0?{lat:e.lat,lng:e.lng}:e.metadata.defaultCenter,l=e.lat&&e.lat>0?15:e.metadata.defaultZoom,i=n.length>0?o.default.createElement(c.default,{markers:n,defaultCenter:r,defaultZoom:l}):null,p=e.media&&e.media.length>0?o.default.createElement(d.default,{isAdmin:this.state.data.metadata.isAdmin,alt:e.name+" ("+e.areaName+")",media:e.media,showThumbnails:e.media.length>1,removeMedia:this.onRemoveMedia.bind(this)}):null,b=null;i&&p?b=o.default.createElement(f.Tabs,{activeKey:this.state.tabIndex,animation:!1,onSelect:this.handleTabsSelection.bind(this),id:"sector_tab",unmountOnExit:!0},o.default.createElement(f.Tab,{eventKey:1,title:"Topo"},1==this.state.tabIndex&&p),o.default.createElement(f.Tab,{eventKey:2,title:"Map"},2==this.state.tabIndex&&i)):i?b=i:p&&(b=p);var y=e.problems.length>0?e.problems[e.problems.length-1].nr+1:1;return o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(e.metadata.jsonLd)}}),o.default.createElement("title",null,e.metadata.title),o.default.createElement("meta",{name:"description",content:e.metadata.description})),o.default.createElement(f.Breadcrumb,null,this.state&&this.state.data&&this.state.data.metadata.isAdmin?o.default.createElement("div",{style:{float:"right"}},o.default.createElement(f.ButtonGroup,null,o.default.createElement(f.OverlayTrigger,{placement:"top",overlay:o.default.createElement(f.Tooltip,{id:-1},"Add problem")},o.default.createElement(m.LinkContainer,{to:{pathname:"/problem/edit/-1",query:{idSector:e.id,nr:y,lat:e.lat,lng:e.lng}}},o.default.createElement(f.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(h.FontAwesomeIcon,{icon:"plus-square",inverse:!0})))),o.default.createElement(f.OverlayTrigger,{placement:"top",overlay:o.default.createElement(f.Tooltip,{id:e.id},"Edit sector")},o.default.createElement(m.LinkContainer,{to:{pathname:"/sector/edit/"+e.id,query:{idArea:e.areaId,lat:e.lat,lng:e.lng}}},o.default.createElement(f.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(h.FontAwesomeIcon,{icon:"edit",inverse:!0})))))):null,o.default.createElement(u.Link,{to:"/"},"Home")," / ",o.default.createElement(u.Link,{to:"/browse"},"Browse")," / ",o.default.createElement(u.Link,{to:"/area/"+e.areaId},e.areaName)," ",1===e.areaVisibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===e.areaVisibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"})," / ",o.default.createElement("font",{color:"#777"},e.name)," ",1===e.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===e.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"})),b,e.comment?o.default.createElement(f.Well,null,e.comment):null,o.default.createElement(f.Table,{striped:!0,condensed:!0,hover:!0},o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("th",null,o.default.createElement(h.FontAwesomeIcon,{icon:"hashtag"})),o.default.createElement("th",null,"Name"),o.default.createElement("th",null,"Description"),!e.metadata.isBouldering&&o.default.createElement("th",null,"Type"),o.default.createElement("th",null,"Grade"),o.default.createElement("th",null,"FA"),o.default.createElement("th",null,"Ticks"),o.default.createElement("th",null,"Stars"),o.default.createElement("th",null,o.default.createElement(h.FontAwesomeIcon,{icon:"camera"})),o.default.createElement("th",null,o.default.createElement(h.FontAwesomeIcon,{icon:"video"})),o.default.createElement("th",null,o.default.createElement(h.FontAwesomeIcon,{icon:"map-marker"})))),o.default.createElement("tbody",null,a)))}}]),t}();E.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(E)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=p(r),l=a(2),i=a(1),s=p(a(7)),u=(a(4),a(8)),c=a(3),d=a(11),f=p(a(12)),m=a(5),h=a(6);function p(e){return e&&e.__esModule?e:{default:e}}var b=(0,d.withScriptjs)((0,d.withGoogleMap)(function(e){return o.default.createElement(d.GoogleMap,{defaultZoom:e.defaultZoom,defaultCenter:e.defaultCenter,defaultMapTypeId:google.maps.MapTypeId.TERRAIN,onClick:e.onClick.bind(void 0),onRightClick:e.onRightClick.bind(void 0)},e.markers,e.outline)})),y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.sectorId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.sectorId!==this.props.match.params.sectorId&&this.refresh(this.props.match.params.sectorId)}},{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"onNameChanged",value:function(e){var t=this.state.data;t.name=e.target.value,this.setState({data:t})}},{key:"onVisibilityChanged",value:function(e,t){var a=this.state.data;a.visibility=e,this.setState({data:a})}},{key:"onCommentChanged",value:function(e){var t=this.state.data;t.comment=e.target.value,this.setState({data:t})}},{key:"onNewMediaChanged",value:function(e){var t=this.state.data;t.newMedia=e,this.setState({data:t})}},{key:"save",value:function(e){var t=this;e.preventDefault(),this.setState({isSaving:!0});var a=this.props.cookies.get("access_token");(0,h.postSector)(a,this.props.location.query.idArea,this.state.data.id,this.state.data.visibility,this.state.data.name,this.state.data.comment,this.state.data.lat,this.state.data.lng,this.state.data.newMedia).then(function(e){t.setState({pushUrl:"/sector/"+e.id})}).catch(function(e){console.warn(e),t.setState({error:e})})}},{key:"onMapClick",value:function(e){var t=this.state.data;t.lat=e.latLng.lat(),t.lng=e.latLng.lng(),this.setState({data:t})}},{key:"onMapRightClick",value:function(e){var t=this.state.data,a=e.latLng.lat()+","+e.latLng.lng();t.polygonCoords?t.polygonCoords=t.polygonCoords+";"+a:t.polygonCoords=a,this.setState({data:t})}},{key:"resetMapPolygon",value:function(e){var t=this.state.data;t.polygonCoords=null,this.setState({data:t})}},{key:"onCancel",value:function(){window.history.back()}},{key:"render",value:function(){if(this.state.error)return o.default.createElement("h3",null,this.state.error.toString());if(this.state.pushUrl)return o.default.createElement(u.Redirect,{to:this.state.pushUrl,push:!0});if(!(this.props&&this.props.match&&this.props.match.params&&this.props.match.params.sectorId&&this.props.location&&this.props.location.query&&this.props.location.query.idArea))return o.default.createElement("span",null,o.default.createElement("h3",null,"Invalid action..."));if(!this.state.data)return o.default.createElement("center",null,o.default.createElement(m.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));this.state.data.metadata.isAdmin||this.setState({pushUrl:"/login",error:null});var e=this.state.data.polygonCoords?this.state.data.polygonCoords.split(";").map(function(e,t){var a=e.split(",");return{lat:parseFloat(a[0]),lng:parseFloat(a[1])}}):[],t="";1==e.length?t=o.default.createElement(d.Marker,{position:{lat:e[0].lat,lng:e[0].lng}}):e.length>1&&(t=o.default.createElement(d.Polygon,{paths:e,options:{strokeColor:"#FF3300",strokeOpacity:"0.5",strokeWeight:"2",fillColor:"#FF3300",fillOpacity:"0.15"},onClick:this.onMapClick.bind(this),onRightclick:this.onMapRightClick.bind(this)}));var a="Visible for everyone";1===this.state.data.visibility?a="Only visible for administrators":2===this.state.data.visibility&&(a="Only visible for super administrators");var n=this.props&&this.props.location&&this.props.location.query&&this.props.location.query.lat&&parseFloat(this.props.location.query.lat)>0?{lat:parseFloat(this.props.location.query.lat),lng:parseFloat(this.props.location.query.lng)}:this.state.data.metadata.defaultCenter,r=this.props&&this.props.location&&this.props.location.query&&this.props.location.query.lat&&parseFloat(this.props.location.query.lat)>0?14:this.state.data.metadata.defaultZoom;return o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("title",null,this.state.data.metadata.title)),o.default.createElement(c.Well,null,o.default.createElement("form",{onSubmit:this.save.bind(this)},o.default.createElement(c.FormGroup,{controlId:"formControlsName"},o.default.createElement(c.ControlLabel,null,"Sector name"),o.default.createElement(c.FormControl,{type:"text",value:this.state.data.name,placeholder:"Enter name",onChange:this.onNameChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsComment"},o.default.createElement(c.ControlLabel,null,"Comment"),o.default.createElement(c.FormControl,{style:{height:"100px"},componentClass:"textarea",placeholder:"Enter comment",value:this.state.data.comment,onChange:this.onCommentChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsVisibility"},o.default.createElement(c.ControlLabel,null,"Visibility"),o.default.createElement("br",null),o.default.createElement(c.DropdownButton,{title:a,id:"bg-nested-dropdown"},o.default.createElement(c.MenuItem,{eventKey:"0",onSelect:this.onVisibilityChanged.bind(this,0)},"Visible for everyone"),o.default.createElement(c.MenuItem,{eventKey:"1",onSelect:this.onVisibilityChanged.bind(this,1)},"Only visible for administrators"),this.state.data.metadata.isSuperAdmin&&o.default.createElement(c.MenuItem,{eventKey:"2",onSelect:this.onVisibilityChanged.bind(this,2)},"Only visible for super administrators"))),o.default.createElement(c.FormGroup,{controlId:"formControlsMedia"},o.default.createElement(f.default,{onMediaChanged:this.onNewMediaChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsMap"},o.default.createElement(c.ControlLabel,null,"Left mouse button to position parking coordinate, right mouse button to add polygon points (sector outline)"),o.default.createElement("br",null),o.default.createElement("section",{style:{height:"600px"}},o.default.createElement(b,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCpaVd5518yMB-oiIyP5JnTVWMfrOv4sAI&v=3.exp",loadingElement:o.default.createElement("div",{style:{height:"100%"}}),containerElement:o.default.createElement("div",{style:{height:"100%"}}),mapElement:o.default.createElement("div",{style:{height:"100%"}}),defaultZoom:r,defaultCenter:n,onClick:this.onMapClick.bind(this),onRightClick:this.onMapRightClick.bind(this),markers:0!=this.state.data.lat&&0!=this.state.data.lng?o.default.createElement(d.Marker,{position:{lat:this.state.data.lat,lng:this.state.data.lng},icon:{url:"https://maps.google.com/mapfiles/kml/shapes/parking_lot_maps.png",scaledSize:new google.maps.Size(32,32)}}):"",outline:t}))),o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.Button,{bsStyle:"warning",onClick:this.resetMapPolygon.bind(this)},"Clear polygon"),o.default.createElement(c.Button,{bsStyle:"danger",onClick:this.onCancel.bind(this)},"Cancel"),o.default.createElement(c.Button,{type:"submit",bsStyle:"success",disabled:this.state.isSaving},this.state.isSaving?"Saving...":"Save sector")))))}}]),t}();y.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(y)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=h(r),l=a(2),i=a(1),s=(h(a(16)),a(4)),u=a(3),c=a(8),d=a(5),f=a(6),m=a(19);function h(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return(n=e.staticContext.data)&&(a.state={mediaId:n.mediaId,nr:n.nr,w:n.w,h:n.h,ctrl:n.ctrl,svgId:n.svgId,points:n.points,readOnlySvgs:n.readOnlySvgs,activePoint:n.activePoint,draggedPoint:n.draggedPoint,draggedCubic:n.draggedCubic,hasAnchor:n.hasAnchor,areaId:n.areaId,areaName:n.areaName,areaVisibility:n.areaVisibility,sectorId:n.sectorId,sectorName:n.sectorName,sectorVisibility:n.sectorVisibility,id:n.id,name:n.name,grade:n.grade,visibility:n.visibility,metadata:n.metadata}),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){this.state&&this.state.id||this.refresh(this.props.match.params.problemIdMediaId),document&&(document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",this.handleKeyUp.bind(this)))}},{key:"componentDidUpdate",value:function(e,t){e.match.params.problemIdMediaId!==this.props.match.params.problemIdMediaId&&this.refresh(this.props.match.params.problemIdMediaId)}},{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{mediaId:e.mediaId,nr:e.nr,w:e.w,h:e.h,ctrl:e.ctrl,svgId:e.svgId,points:e.points,readOnlySvgs:e.readOnlySvgs,activePoint:e.activePoint,draggedPoint:e.draggedPoint,draggedCubic:e.draggedCubic,hasAnchor:e.hasAnchor,areaId:e.areaId,areaName:e.areaName,areaVisibility:e.areaVisibility,sectorId:e.sectorId,sectorName:e.sectorName,sectorVisibility:e.sectorVisibility,id:e.id,name:e.name,grade:e.grade,visibility:e.visibility,metadata:e.metadata}})})}},{key:"componentWillUnmount",value:function(){document&&(document.removeEventListener("keydown",this.handleKeyDown.bind(this)),document.removeEventListener("keyup",this.handleKeyUp.bind(this)))}},{key:"handleKeyDown",value:function(e){e.ctrlKey&&this.setState({ctrl:!0})}},{key:"handleKeyUp",value:function(e){e.ctrlKey||this.setState({ctrl:!1})}},{key:"setHasAnchor",value:function(e){this.setState({hasAnchor:e})}},{key:"onCancel",value:function(){window.history.back()}},{key:"save",value:function(e){var t=this;e.preventDefault();var a=this.props.cookies.get("access_token");(0,f.postProblemSvg)(a,this.state.id,this.state.mediaId,this.state.points.length<2,this.state.svgId,this.generatePath(),this.state.hasAnchor).then(function(e){t.setState({pushUrl:"/problem/"+t.state.id})}).catch(function(e){console.warn(e),t.setState({error:e})})}},{key:"cancelDragging",value:function(e){this.setState({draggedPoint:!1,draggedCubic:!1})}},{key:"getMouseCoords",value:function(e){var t=this.refs["buldreinfo-svg-edit-img"].getBoundingClientRect(),a=this.state.w/t.width,n=this.state.h/t.height;return{x:Math.round((e.clientX-t.left)*a),y:Math.round((e.clientY-t.top)*n)}}},{key:"addPoint",value:function(e){if(this.state.ctrl){var t=this.getMouseCoords(e),a=this.state.points;a.push(t),this.setState({points:a,activePoint:a.length-1})}}},{key:"generatePath",value:function(){var e="";return this.state.points.forEach(function(t,a){0===a?e+="M ":t.q?e+="Q "+t.q.x+" "+t.q.y+" ":t.c?e+="C "+t.c[0].x+" "+t.c[0].y+" "+t.c[1].x+" "+t.c[1].y+" ":t.a?e+="A "+t.a.rx+" "+t.a.ry+" "+t.a.rot+" "+t.a.laf+" "+t.a.sf+" ":e+="L ",e+=t.x+" "+t.y+" "}),e}},{key:"handleMouseMove",value:function(e){return e.preventDefault(),this.state.ctrl||(this.state.draggedPoint?this.setPointCoords(this.getMouseCoords(e)):!1!==this.state.draggedCubic&&this.setCubicCoords(this.getMouseCoords(e),this.state.draggedCubic)),!1}},{key:"setPointCoords",value:function(e){var t=this.state.points,a=this.state.activePoint;t[a].x=e.x,t[a].y=e.y,this.setState({points:t})}},{key:"setCubicCoords",value:function(e,t){var a=this.state.points,n=this.state.activePoint;a[n].c[t].x=e.x,a[n].c[t].y=e.y,this.setState({points:a})}},{key:"setDraggedPoint",value:function(e){this.state.ctrl||this.setState({activePoint:e,draggedPoint:!0})}},{key:"setDraggedCubic",value:function(e,t){this.state.ctrl||this.setState({activePoint:e,draggedCubic:t})}},{key:"setPointType",value:function(e){var t=this.state.points,a=this.state.activePoint;if(0!==a){switch(e){case"L":t[a]={x:t[a].x,y:t[a].y};break;case"C":t[a]={x:t[a].x,y:t[a].y,c:[{x:(t[a].x+t[a-1].x-50)/2,y:(t[a].y+t[a-1].y)/2},{x:(t[a].x+t[a-1].x+50)/2,y:(t[a].y+t[a-1].y)/2}]}}this.setState({points:t})}}},{key:"removeActivePoint",value:function(e){var t=this.state.points,a=this.state.activePoint;t.length>1&&0!==a&&(t.splice(a,1),this.setState({points:t,activePoint:t.length-1}))}},{key:"reset",value:function(e){this.setState({ctrl:!1,points:[],activePoint:0,draggedPoint:!1,draggedCubic:!1,hasAnchor:!1})}},{key:"render",value:function(){var e=this;if(!this.state||!this.state.id)return o.default.createElement("center",null,o.default.createElement(d.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));if(this.state.error)return o.default.createElement("h3",null,this.state.error.toString());if(this.state.pushUrl)return o.default.createElement(c.Redirect,{to:this.state.pushUrl,push:!0});this.state.metadata.isAdmin||this.setState({pushUrl:"/login",error:null});var t=this.state.points.map(function(t,a,n){var r=[];return t.c&&r.push(o.default.createElement("g",{className:"buldreinfo-svg-edit-opacity"},o.default.createElement("line",{className:"buldreinfo-svg-pointer buldreinfo-svg-route",x1:n[a-1].x,y1:n[a-1].y,x2:t.c[0].x,y2:t.c[0].y,strokeWidth:.0026*e.state.w,strokeDasharray:.003*e.state.w}),o.default.createElement("line",{className:"buldreinfo-svg-pointer buldreinfo-svg-route",x1:t.x,y1:t.y,x2:t.c[1].x,y2:t.c[1].y,strokeWidth:.0026*e.state.w,strokeDasharray:.003*e.state.w}),o.default.createElement("circle",{className:"buldreinfo-svg-pointer buldreinfo-svg-ring",cx:t.c[0].x,cy:t.c[0].y,r:.003*e.state.w,onMouseDown:e.setDraggedCubic.bind(e,a,0)}),o.default.createElement("circle",{className:"buldreinfo-svg-pointer buldreinfo-svg-ring",cx:t.c[1].x,cy:t.c[1].y,r:.003*e.state.w,onMouseDown:e.setDraggedCubic.bind(e,a,1)}))),o.default.createElement("g",{className:"buldreinfo-svg-ring-group"+(e.state.activePoint===a?"  is-active":"")},r,o.default.createElement("circle",{className:"buldreinfo-svg-pointer buldreinfo-svg-ring",cx:t.x,cy:t.y,r:.003*e.state.w,onMouseDown:e.setDraggedPoint.bind(e,a)}))}),a=this.generatePath();return o.default.createElement("span",null,o.default.createElement(u.Breadcrumb,null,o.default.createElement(s.Link,{to:"/"},"Home")," / ",o.default.createElement(s.Link,{to:"/browse"},"Browse")," / ",o.default.createElement(s.Link,{to:"/area/"+this.state.areaId},this.state.areaName)," ",1===this.state.areaVisibility&&o.default.createElement(d.FontAwesomeIcon,{icon:"lock"}),2===this.state.areaVisibility&&o.default.createElement(d.FontAwesomeIcon,{icon:"user-secret"})," / ",o.default.createElement(s.Link,{to:"/sector/"+this.state.sectorId},this.state.sectorName)," ",1===this.state.sectorVisibility&&o.default.createElement(d.FontAwesomeIcon,{icon:"lock"}),2===this.state.sectorVisibility&&o.default.createElement(d.FontAwesomeIcon,{icon:"user-secret"})," / ",o.default.createElement(s.Link,{to:"/problem/"+this.state.id},this.state.nr," ",this.state.name," ",this.state.grade)," ",1===this.state.visibility&&o.default.createElement(d.FontAwesomeIcon,{icon:"lock"}),2===this.state.visibility&&o.default.createElement(d.FontAwesomeIcon,{icon:"user-secret"})),o.default.createElement(u.Well,{bsSize:"small",onMouseUp:this.cancelDragging.bind(this),onMouseLeave:this.cancelDragging.bind(this)},o.default.createElement("form",{onSubmit:this.save.bind(this)},o.default.createElement(u.FormGroup,{controlId:"formControlsInfo"},o.default.createElement(u.Alert,{bsStyle:"info"},o.default.createElement("center",null,o.default.createElement("strong",null,"CTRL + CLICK")," to add a point | ",o.default.createElement("strong",null,"CLICK")," to select a point | ",o.default.createElement("strong",null,"CLICK AND DRAG")," to move a point",o.default.createElement("br",null),o.default.createElement(u.ButtonGroup,null,0!==this.state.activePoint&&o.default.createElement(u.DropdownButton,{title:this.state.points[this.state.activePoint].c?"Selected point: Curve to":"Selected point: Line to",id:"bg-nested-dropdown"},o.default.createElement(u.MenuItem,{eventKey:"0",onSelect:this.setPointType.bind(this,"L")},"Selected point: Line to"),o.default.createElement(u.MenuItem,{eventKey:"1",onSelect:this.setPointType.bind(this,"C")},"Selected point: Curve to")),0!==this.state.activePoint&&o.default.createElement(u.Button,{onClick:this.removeActivePoint.bind(this)},"Remove this point"),o.default.createElement(u.DropdownButton,{title:!0===this.state.hasAnchor?"Route has anchor":"No anchor on route",disabled:0===this.state.points.length,id:"bg-nested-dropdown"},o.default.createElement(u.MenuItem,{eventKey:"0",onSelect:this.setHasAnchor.bind(this,!1)},"No anchor on route"),o.default.createElement(u.MenuItem,{eventKey:"1",onSelect:this.setHasAnchor.bind(this,!0)},"Route has anchor")),o.default.createElement(u.Button,{bsStyle:"warning",disabled:0===this.state.points.length,onClick:this.reset.bind(this)},"Reset path"),o.default.createElement(u.Button,{bsStyle:"danger",onClick:this.onCancel.bind(this)},"Cancel"),o.default.createElement(u.Button,{type:"submit",bsStyle:"success"},this.state.points.length>=2?"Save":"Delete path"))))),o.default.createElement(u.FormGroup,{controlId:"formControlsImage"},o.default.createElement("svg",{viewBox:"0 0 "+this.state.w+" "+this.state.h,onClick:this.addPoint.bind(this),onMouseMove:this.handleMouseMove.bind(this)},o.default.createElement("image",{ref:"buldreinfo-svg-edit-img",xlinkHref:(0,f.getImageUrl)(this.state.mediaId),width:"100%",height:"100%"}),(0,m.parseReadOnlySvgs)(this.state.readOnlySvgs,this.state.w,this.state.h),o.default.createElement("path",{className:"buldreinfo-svg-route",d:a,strokeWidth:.002*this.state.w}),t)),o.default.createElement(u.FormGroup,{controlId:"formControlsPath"},a))))}}]),t}();p.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(p)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=b(r),l=a(2),i=a(1),s=b(a(7)),u=a(4),c=a(9),d=a(3),f=a(14),m=b(a(62)),h=b(a(20)),p=a(5);function b(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n,showTickModal:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.userId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.userId!==this.props.match.params.userId&&this.refresh(this.props.match.params.userId)}},{key:"closeTickModal",value:function(e){this.setState({showTickModal:!1}),this.refresh(this.props.match.params.userId)}},{key:"openTickModal",value:function(e,t){this.setState({currTick:e,showTickModal:!0})}},{key:"formatName",value:function(e,t){return o.default.createElement("span",null,o.default.createElement(u.Link,{to:"/problem/"+t.idProblem},t.name)," ",1===t.visibility&&o.default.createElement(p.FontAwesomeIcon,{icon:"lock"}),2===t.visibility&&o.default.createElement(p.FontAwesomeIcon,{icon:"user-secret"}))}},{key:"formatComment",value:function(e,t){if(t.comment){if(t.comment.length>40){var a=o.default.createElement(d.Tooltip,{id:t.idProblem},t.comment);return o.default.createElement(d.OverlayTrigger,{key:t.idProblem,placement:"top",overlay:a},o.default.createElement("span",null,t.comment.substring(0,40)+"..."))}return t.comment}return""}},{key:"formatStars",value:function(e,t){var a=null;if(.5===t.stars)a=o.default.createElement(p.FontAwesomeIcon,{icon:"star-half"});else if(1===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:2},o.default.createElement(p.FontAwesomeIcon,{icon:"star"}));else if(1.5===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:3},o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star-half"}));else if(2===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:4},o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star"}));else if(2.5===t.stars)a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:5},o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star-half"}));else{if(3!==t.stars)return"";a=o.default.createElement("div",{style:{whiteSpace:"nowrap"},id:6},o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star"}))}return o.default.createElement(d.OverlayTrigger,{placement:"top",overlay:o.default.createElement(d.Popover,{id:0,title:"Guidelines"},o.default.createElement(p.FontAwesomeIcon,{icon:"star"})," Nice",o.default.createElement("br",null),o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star"})," Very nice",o.default.createElement("br",null),o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star"}),o.default.createElement(p.FontAwesomeIcon,{icon:"star"})," Fantastic!")},a)}},{key:"formatFa",value:function(e,t){return e?o.default.createElement(p.FontAwesomeIcon,{icon:"check"}):""}},{key:"formatEdit",value:function(e,t){return 0==this.state.data.readOnly&&0!=t.id?o.default.createElement(d.OverlayTrigger,{placement:"top",overlay:o.default.createElement(d.Tooltip,{id:t.id},"Edit tick")},o.default.createElement(d.Button,{bsSize:"xsmall",bsStyle:"primary",onClick:this.openTickModal.bind(this,t)},o.default.createElement(p.FontAwesomeIcon,{icon:"edit",inverse:!0}))):""}},{key:"sortDate",value:function(e,t,a){var n=e.date?(parseInt(e.date.substring(0,2))<50?"20":"19")+e.date:"",r=t.date?(parseInt(t.date.substring(0,2))<50?"20":"19")+t.date:"";return"asc"===a?n.localeCompare(r):r.localeCompare(n)}},{key:"sortGrade",value:function(e,t,a){var n=e.gradeNumber?e.gradeNumber:0,r=t.gradeNumber?t.gradeNumber:0;return"asc"===a?n<r?-1:n>r?1:0:r<n?-1:r>n?1:0}},{key:"sortComment",value:function(e,t,a){var n=e.comment?e.comment:"",r=t.comment?t.comment:"";return"asc"===a?n.localeCompare(r):r.localeCompare(n)}},{key:"render",value:function(){var e=this.state.data;if(!e)return o.default.createElement("center",null,o.default.createElement(p.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}));var t=e.ticks.filter(function(e){return!e.fa}).length,a=e.ticks.filter(function(e){return e.fa}).length,n=e.ticks.length>0?o.default.createElement(m.default,{data:e.ticks}):null;return o.default.createElement("span",null,o.default.createElement(s.default,null,o.default.createElement("title",null,e.metadata.title),o.default.createElement("meta",{name:"description",content:e.metadata.description})),this.state.currTick?o.default.createElement(h.default,{idTick:this.state.currTick.id,idProblem:this.state.currTick.idProblem,date:this.state.currTick.date,comment:this.state.currTick.comment,grade:this.state.currTick.grade,grades:e.metadata.grades,stars:this.state.currTick.stars,show:this.state.showTickModal,onHide:this.closeTickModal.bind(this)}):"",o.default.createElement(d.Breadcrumb,null,e.metadata.isAuthenticated&&this.state.currTick&&0==this.state.data.readOnly&&o.default.createElement("div",{style:{float:"right"}},o.default.createElement(d.OverlayTrigger,{placement:"top",overlay:o.default.createElement(d.Tooltip,{id:e.id},"Edit user")},o.default.createElement(c.LinkContainer,{to:"/user/"+e.id+"/edit"},o.default.createElement(d.Button,{bsStyle:"primary",bsSize:"xsmall"},o.default.createElement(p.FontAwesomeIcon,{icon:"edit",inverse:!0}))))),o.default.createElement(u.Link,{to:"/"},"Home")," / ",o.default.createElement("font",{color:"#777"},e.name)),o.default.createElement(d.Well,{bsSize:"small"},"First ascents: ",a,o.default.createElement("br",null),"Public ascents: ",t,o.default.createElement("br",null),"Pictures taken: ",e.numImagesCreated,o.default.createElement("br",null),"Appearance in pictures: ",e.numImageTags,o.default.createElement("br",null),"Videos created: ",e.numVideosCreated,o.default.createElement("br",null),"Appearance in videos: ",e.numVideoTags),n,o.default.createElement(f.BootstrapTable,{data:e.ticks,condensed:!0,hover:!0,columnFilter:!1},o.default.createElement(f.TableHeaderColumn,{dataField:"idProblem",isKey:!0,hidden:!0},"idProblem"),o.default.createElement(f.TableHeaderColumn,{dataField:"dateHr",dataSort:!0,sortFunc:this.sortDate.bind(this),dataAlign:"center",width:"70"},"Date"),o.default.createElement(f.TableHeaderColumn,{dataField:"name",dataSort:!0,dataFormat:this.formatName.bind(this),width:"300"},"Name"),o.default.createElement(f.TableHeaderColumn,{dataField:"grade",dataSort:!0,sortFunc:this.sortGrade.bind(this),dataAlign:"center",width:"70"},"Grade"),o.default.createElement(f.TableHeaderColumn,{dataField:"comment",dataSort:!0,sortFunc:this.sortComment.bind(this),dataFormat:this.formatComment.bind(this),width:"300"},"Comment"),o.default.createElement(f.TableHeaderColumn,{dataField:"stars",dataSort:!0,dataFormat:this.formatStars.bind(this),dataAlign:"center",width:"70"},"Stars"),o.default.createElement(f.TableHeaderColumn,{dataField:"fa",dataSort:!0,dataFormat:this.formatFa.bind(this),dataAlign:"center",width:"50"},"FA"),o.default.createElement(f.TableHeaderColumn,{dataField:"edit",dataFormat:this.formatEdit.bind(this),dataAlign:"center",width:"30"}," ")))}}]),t}();y.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(y)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(3);var i=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){var e=[];this.props.data.map(function(t){var a=e.filter(function(e){return e.gradeNumber===t.gradeNumber});a[0]?t.fa?a[0].fa++:a[0].tick++:e.push({gradeNumber:t.gradeNumber,grade:t.grade,fa:t.fa?1:0,tick:t.fa?0:1})}),e.sort(function(e,t){return t.gradeNumber-e.gradeNumber});var t=Math.max.apply(Math,e.map(function(e){return e.fa+e.tick})),a=e.map(function(e,a){var n=e.fa/t*100+"%",r=e.tick/t*100+"%",l={padding:0,textAlign:"center"};return o.default.createElement("tr",{key:a},o.default.createElement("td",{style:l},e.grade),o.default.createElement("td",{style:l},e.fa),o.default.createElement("td",{style:l},e.tick),o.default.createElement("td",{style:l},o.default.createElement("strong",null,e.fa+e.tick)),o.default.createElement("td",{style:{width:"100%",verticalAlign:"middle"}},o.default.createElement("div",{style:{width:n,height:"10px",backgroundColor:"#3182bd",float:"left"}}),o.default.createElement("div",{style:{width:r,height:"10px",backgroundColor:"#6baed6",marginLeft:n}})))});return o.default.createElement(l.Table,{responsive:!0},o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("th",null,"Grade"),o.default.createElement("th",null,"FA"),o.default.createElement("th",null,"Tick"),o.default.createElement("th",null,"Total"),o.default.createElement("th",null))),o.default.createElement("tbody",null,a))}}]),t}();t.default=i},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),l=a(2),i=a(1),s=a(4),u=a(8),c=a(3),d=a(5),f=a(6);var m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=void 0;return n=e.staticContext.data,a.state={data:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){this.state.data||this.refresh(this.props.match.params.userId)}},{key:"componentDidUpdate",value:function(e,t){e.match.params.userId!==this.props.match.params.userId&&this.refresh(this.props.match.params.userId)}},{key:"refresh",value:function(e){var t=this,a=this.props.cookies.get("access_token");this.props.fetchInitialData(a,e).then(function(e){return t.setState(function(){return{data:e}})})}},{key:"save",value:function(e){var t=this;if(e.preventDefault(),"error"===this.validateFirstname(null))this.setState({message:o.default.createElement(c.Panel,{bsStyle:"danger"},"Invalid firstname.")});else if("error"===this.validateLastname(null))this.setState({message:o.default.createElement(c.Panel,{bsStyle:"danger"},"Invalid lastname.")});else if("error"===this.validateUsername(null))this.setState({message:o.default.createElement(c.Panel,{bsStyle:"danger"},"Invalid username.")});else if("error"===this.validateCurrentPassword(null)||"error"===this.validateNewPassword(null)||"error"===this.validateNewPassword2(null))this.setState({message:o.default.createElement(c.Panel,{bsStyle:"danger"},"Invalid password.")});else{this.props.cookies.get("access_token");(0,f.postUserEdit)(this.state.id,this.state.username,this.state.firstname,this.state.lastname,this.state.currentPassword,this.state.newPassword).then(function(e){t.setState({pushUrl:"/user"})}).catch(function(e){console.warn(e),t.setState({message:o.default.createElement(c.Panel,{bsStyle:"danger"},e.toString())})})}}},{key:"onCancel",value:function(){window.history.back()}},{key:"onFirstnameChanged",value:function(e){this.setState({firstname:e.target.value})}},{key:"onLastnameChanged",value:function(e){this.setState({lastname:e.target.value})}},{key:"onUsernameChanged",value:function(e){this.setState({username:e.target.value})}},{key:"onCurrentPasswordChanged",value:function(e){this.setState({currentPassword:e.target.value})}},{key:"onNewPasswordChanged",value:function(e){this.setState({newPassword:e.target.value})}},{key:"onConfirmNewPasswordChanged",value:function(e){this.setState({newPassword2:e.target.value})}},{key:"validateFirstname",value:function(){return this.state.firstname.length<1?"error":"success"}},{key:"validateLastname",value:function(){return this.state.lastname.length<1?"error":"success"}},{key:"validateUsername",value:function(){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(this.state.username)?"success":"error"}},{key:"validateCurrentPassword",value:function(){return"success"}},{key:"validateNewPassword",value:function(){return!this.state.currentPassword&&!this.state.newPassword2||this.state.newPassword?this.state.newPassword&&this.state.newPassword.length<8?"error":"success":"error"}},{key:"validateNewPassword2",value:function(){return!this.state.currentPassword&&!this.state.newPassword||this.state.newPassword2?this.state.newPassword2&&this.state.newPassword2.length<8?"error":this.state.newPassword2&&this.state.newPassword!=this.state.newPassword2?"error":"success":"error"}},{key:"render",value:function(){return this.state?this.state.pushUrl?o.default.createElement(u.Redirect,{to:this.state.pushUrl,push:!0}):(this.state.metadata.isAuthenticated||this.setState({pushUrl:"/login",error:null}),o.default.createElement("span",null,o.default.createElement(c.Breadcrumb,null,o.default.createElement(s.Link,{to:"/"},"Home")," / ",o.default.createElement("font",{color:"#777"},"User edit")),o.default.createElement(c.Well,null,this.state.message,o.default.createElement("form",{onSubmit:this.save.bind(this)},o.default.createElement(c.FormGroup,{controlId:"formControlsFirstname",validationState:this.validateFirstname()},o.default.createElement(c.ControlLabel,null,"Firstname"),o.default.createElement(c.FormControl,{type:"text",value:this.state.firstname,placeholder:"Enter firstname",onChange:this.onFirstnameChanged.bind(this)}),o.default.createElement(c.FormControl.Feedback,null)),o.default.createElement(c.FormGroup,{controlId:"formControlsLastname",validationState:this.validateLastname()},o.default.createElement(c.ControlLabel,null,"Lastname"),o.default.createElement(c.FormControl,{type:"text",value:this.state.lastname,placeholder:"Enter lastname",onChange:this.onLastnameChanged.bind(this)}),o.default.createElement(c.FormControl.Feedback,null)),o.default.createElement(c.FormGroup,{controlId:"formControlsUsername",validationState:this.validateUsername()},o.default.createElement(c.ControlLabel,null,"Username"),o.default.createElement(c.FormControl,{type:"email",value:this.state.username,placeholder:"Enter username",onChange:this.onUsernameChanged.bind(this)}),o.default.createElement(c.FormControl.Feedback,null),o.default.createElement(c.HelpBlock,null,"You must enter a valid email address.")),o.default.createElement("hr",null),o.default.createElement("h4",null,"Only fill following fields if you want to change your password"),o.default.createElement(c.FormGroup,{controlId:"formControlsCurrentPassword",validationState:this.validateCurrentPassword()},o.default.createElement(c.ControlLabel,null,"Current password"),o.default.createElement(c.FormControl,{type:"password",placeholder:"Enter current password",onChange:this.onCurrentPasswordChanged.bind(this)})),o.default.createElement(c.FormGroup,{controlId:"formControlsNewPassword",validationState:this.validateNewPassword()},o.default.createElement(c.ControlLabel,null,"New password"),o.default.createElement(c.FormControl,{type:"password",placeholder:"Enter new password",onChange:this.onNewPasswordChanged.bind(this)}),o.default.createElement(c.FormControl.Feedback,null),o.default.createElement(c.HelpBlock,null,"At least 8 characters.")),o.default.createElement(c.FormGroup,{controlId:"formControlsNewPassword2",validationState:this.validateNewPassword2()},o.default.createElement(c.ControlLabel,null,"Confirm new password"),o.default.createElement(c.FormControl,{type:"password",placeholder:"Confirm new password",onChange:this.onConfirmNewPasswordChanged.bind(this)}),o.default.createElement(c.FormControl.Feedback,null),o.default.createElement(c.HelpBlock,null,"Must match new password.")),o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.Button,{bsStyle:"danger",onClick:this.onCancel.bind(this)},"Cancel"),o.default.createElement(c.Button,{type:"submit",bsStyle:"success"},"Save")))))):o.default.createElement("center",null,o.default.createElement(d.FontAwesomeIcon,{icon:"spinner",spin:!0,size:"3x"}))}}]),t}();m.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(m)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(0),o=b(r),l=a(2),i=a(1),s=a(3),u=a(9),c=b(a(65)),d=a(66),f=a(8),m=b(a(67)),h=a(5),p=a(6);function b(e){return e&&e.__esModule?e:{default:e}}var y=function(e){var t="#4caf50";return"A"===e.value.avatar?t="#ff5722":"S"===e.value.avatar&&(t="#673ab7"),o.default.createElement(d.components.Option,e,o.default.createElement("div",null,o.default.createElement(m.default,{value:e.value.avatar?e.value.avatar:"7A",size:25,color:t,round:!0,textSizeRatio:2.25,style:{marginRight:"10px"}}),e.label," ",1===e.value.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"lock"}),2===e.value.visibility&&o.default.createElement(h.FontAwesomeIcon,{icon:"user-secret"})))},g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={logo:"/png/buldreinfo_logo_gray.png"},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.cookies.get("access_token");(0,p.getMeta)(t).then(function(t){return e.setState(function(){return{meta:t}})})}},{key:"componentWillReceiveProps",value:function(e){this.setState({pushUrl:null})}},{key:"hoverImage",value:function(e){var t=e?"/png/buldreinfo_logo_white.png":"/png/buldreinfo_logo_gray.png";this.setState({logo:t})}},{key:"search",value:function(e,t){if(e){var a=this.props.cookies.get("access_token");(0,p.postSearch)(a,e).then(function(e){var a=e.map(function(e){return{value:e,label:e.value}});t(a)})}else t(null)}},{key:"onChange",value:function(e){e&&e.value&&e.value.url&&this.setState({pushUrl:e.value.url})}},{key:"render",value:function(){return this.state.pushUrl?o.default.createElement(f.Redirect,{to:this.state.pushUrl,push:!0}):o.default.createElement(s.Navbar,{inverse:!0},o.default.createElement(s.Navbar.Header,null,o.default.createElement(s.Navbar.Brand,null,o.default.createElement(u.LinkContainer,{to:"/"},o.default.createElement("a",{href:"/",onMouseOver:this.hoverImage.bind(this,!0),onMouseOut:this.hoverImage.bind(this,!1)},o.default.createElement("img",{src:this.state.logo})))),o.default.createElement(s.Navbar.Toggle,null)),o.default.createElement(s.Navbar.Collapse,null,o.default.createElement(s.Nav,null,o.default.createElement(u.LinkContainer,{to:"/browse"},o.default.createElement(s.NavItem,{eventKey:1},"Browse")),o.default.createElement(s.NavDropdown,{eventKey:2,title:"Finder",id:"basic-nav-dropdown"},this.state.meta&&this.state.meta.metadata.isSuperAdmin&&o.default.createElement(u.LinkContainer,{to:"/finder/-1"},o.default.createElement(s.MenuItem,{eventKey:2},"Grade: ",o.default.createElement("strong",null,"superadmin"))),this.state.meta&&this.state.meta.metadata.grades.map(function(e,t){return o.default.createElement(u.LinkContainer,{key:"2."+t,to:"/finder/"+e.id},o.default.createElement(s.MenuItem,{eventKey:"3."+t},"Grade: ",o.default.createElement("strong",null,e.grade)))}))),o.default.createElement(s.Navbar.Form,{pullLeft:!0},o.default.createElement(s.FormGroup,{style:{width:"350px"}},o.default.createElement(c.default,{instanceId:"buldreinfo-navigation-search",placeholder:"Search",loadOptions:this.search.bind(this),filterOptions:function(e,t,a){return e},ignoreAccents:!1,onChange:this.onChange.bind(this),components:{Option:y}}))),o.default.createElement(s.Nav,{pullRight:!0},this.props.cookies.get("access_token")?o.default.createElement(s.NavDropdown,{eventKey:4,title:"Logged in",id:"basic-nav-dropdown"},o.default.createElement(u.LinkContainer,{to:"/user"},o.default.createElement(s.MenuItem,{eventKey:4.1},"My profile")),o.default.createElement(s.MenuItem,{divider:!0}),o.default.createElement(u.LinkContainer,{to:"/logout"},o.default.createElement(s.MenuItem,{eventKey:4.2},"Log out"))):o.default.createElement(u.LinkContainer,{to:"/login"},o.default.createElement(s.NavItem,{eventKey:5},"Sign in")),o.default.createElement(s.NavDropdown,{eventKey:6,title:"More",id:"basic-nav-dropdown"},o.default.createElement(u.LinkContainer,{to:"/ethics"},o.default.createElement(s.NavItem,{eventKey:6},"Ethics")),o.default.createElement(s.MenuItem,{divider:!0}),o.default.createElement(s.MenuItem,{eventKey:6.1,href:"mailto:jostein.oygarden@gmail.com"},"Contact"),o.default.createElement(s.MenuItem,{eventKey:6.2,href:"/gpl-3.0.txt",rel:"noopener",target:"_blank"},"GNU Public License"),o.default.createElement(s.MenuItem,{divider:!0}),o.default.createElement(s.MenuItem,{eventKey:6.3,href:"https://buldreinfo.com",rel:"noopener",target:"_blank"},"buldreinfo.com"),o.default.createElement(s.MenuItem,{eventKey:6.4,href:"https://buldring.bergen-klatreklubb.no",rel:"noopener",target:"_blank"},"buldring.bergen-klatreklubb.no"),o.default.createElement(s.MenuItem,{eventKey:6.5,href:"https://buldring.fredrikstadklatreklubb.org",rel:"noopener",target:"_blank"},"buldring.fredrikstadklatreklubb.org"),o.default.createElement(s.MenuItem,{eventKey:6.6,href:"https://buldring.jotunheimenfjellsport.com",rel:"noopener",target:"_blank"},"buldring.jotunheimenfjellsport.com"),o.default.createElement(s.MenuItem,{divider:!0}),o.default.createElement(s.MenuItem,{eventKey:6.7,href:"https://brattelinjer.no",rel:"noopener",target:"_blank"},"brattelinjer.no"),o.default.createElement(s.MenuItem,{eventKey:6.7,href:"https://klatring.jotunheimenfjellsport.com",rel:"noopener",target:"_blank"},"klatring.jotunheimenfjellsport.com")))))}}]),t}();g.propTypes={cookies:(0,l.instanceOf)(i.Cookies).isRequired},t.default=(0,i.withCookies)(g)},function(e,t){e.exports=require("react-select/lib/Async")},function(e,t){e.exports=require("react-select")},function(e,t){e.exports=require("react-avatar")},function(e,t){e.exports=require("react-ga")},function(e,t){e.exports=require("@fortawesome/fontawesome-svg-core")},function(e,t){e.exports=require("@fortawesome/free-solid-svg-icons")},function(e,t){e.exports=require("universal-cookie-express")}]);