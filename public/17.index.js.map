{"version":3,"sources":["webpack:///./app/components/login.js"],"names":["_react","__webpack_require__","s","p","r","o","_reactRouterDom","_reactRouter","i","_reactRouterBootstrap","_reactBootstrap","f","m","e","__esModule","default","Login","props","this","_this","__proto__","Object","getPrototypeOf","call","document","title","_config2","getTitle","state","message","username","password","email","test","event","_this2","validateEmail","_superagent2","get","getUrl","window","location","hostname","withCredentials","end","err","res","setState","_react2","createElement","Panel","bsStyle","toString","key","value","_this3","preventDefault","_auth2","login","loggedIn","pushUrl","target","Redirect","to","push","Breadcrumb","Link","color","Well","onSubmit","bind","FormGroup","controlId","ControlLabel","FormControl","type","placeholder","onChange","onUsernameChanged","onPasswordChanged","ButtonGroup","LinkContainer","Button","onClick","forgotPasswordClick","t","contextTypes","router","_propTypes2","object"],"mappings":"qYAAAA,EAAAC,EAAA,GAAAC,EAAAC,EAAAC,GAAAC,EAAAF,EACAF,EAAA,IACAK,EAAAL,EAAA,IACAM,EAAAN,EAAA,KAAAO,EAAAL,EACAF,EAAA,KACAQ,EAAAR,EAAA,KACAS,EAAAT,EAAA,KAAAU,EAAAR,EACAF,EAAA,MAAAW,EAAAT,EACAF,EAAA,cAAAE,EAAAU,GAAA,OAAAA,KAAAC,WAAAD,GAAAE,QAAAF,GAAA,IAEqBG,cACnB,SAAAA,EAAYC,iGAAOC,KAAAF,GAAA,IAAAG,oKAAAD,MAAAF,EAAAI,WAAAC,OAAAC,eAAAN,IAAAO,KAAAL,KACXD,IADW,OAEjBO,SAASC,MAAMC,EAAAX,QAAOY,WAAa,WACnCR,EAAKS,OACHC,QAAS,KACTC,SAAU,GACVC,SAAU,IANKZ,2XAULa,GAEZ,MADS,yJACCC,KAAKD,+CAGGE,GAAO,IAAAC,EAAAjB,KACpBA,KAAKU,MAAME,SAEJZ,KAAKkB,cAAclB,KAAKU,MAAME,UAGxCO,EAAAtB,QAAQuB,IAAIZ,EAAAX,QAAOwB,OAAO,iCAAmCrB,KAAKU,MAAME,SAAW,aAAeU,OAAOC,SAASC,WAAWC,kBAAkBC,IAAI,SAACC,EAAKC,GACnJD,EACFV,EAAKY,UAAUlB,QAASmB,EAAAjC,QAAAkC,cAAAvC,EAAAwC,OAAOC,QAAQ,UAAUN,EAAIO,cAErDjB,EAAKY,UAAUlB,QAASmB,EAAAjC,QAAAkC,cAAAvC,EAAAwC,OAAOC,QAAQ,WAAf,kEAA8FhB,EAAKP,MAAME,SAAzG,UAN5BZ,KAAK6B,UAAUlB,QAASmB,EAAAjC,QAAAkC,cAAAvC,EAAAwC,OAAOC,QAAQ,UAAf,mCAA8DjC,KAAKU,MAAME,SAAzE,0EAFxBZ,KAAK6B,UAAUlB,QAASmB,EAAAjC,QAAAkC,cAAAvC,EAAAwC,OAAOC,QAAQ,UAAf,8DAAAE,IAAA,QAAAC,MAAA,SActBpB,GAAO,IAAAqB,EAAArC,KACXgB,EAAMsB,iBACNC,EAAA1C,QAAK2C,MAAMxC,KAAKU,MAAME,SAAUZ,KAAKU,MAAMG,SAAU,SAAC4B,GAEpD,OADqBJ,EAAKtC,MAAlBwB,SACHkB,EAGIJ,EAAKR,UAAUlB,QAAS,KAAM+B,QAAS,MAFvCL,EAAKR,UAAUlB,QAASmB,EAAAjC,QAAAkC,cAAAvC,EAAAwC,OAAOC,QAAQ,UAAf,4CAAAE,IAAA,oBAAAC,MAAA,SAOnBzC,GAChBK,KAAK6B,UAAUjB,SAAUjB,EAAEgD,OAAOP,kDAGlBzC,GAChBK,KAAK6B,UAAUhB,SAAUlB,EAAEgD,OAAOP,yCAIlC,OAAIpC,KAAKU,OAASV,KAAKU,MAAMgC,QACnBZ,EAAAjC,QAAAkC,cAAA1C,EAAAuD,UAAUC,GAAI7C,KAAKU,MAAMgC,QAASI,UAG1ChB,EAAAjC,QAAAkC,cAAA,YACED,EAAAjC,QAAAkC,cAAAvC,EAAAuD,WAAA,KACEjB,EAAAjC,QAAAkC,cAAA3C,EAAA4D,MAAMH,GAAA,KAAN,QADF,MAC+Bf,EAAAjC,QAAAkC,cAAA,QAAMkB,MAAM,QAAZ,YAE/BnB,EAAAjC,QAAAkC,cAAAvC,EAAA0D,KAAA,KACGlD,KAAKU,MAAMC,QACZmB,EAAAjC,QAAAkC,cAAA,QAAMoB,SAAUnD,KAAKwC,MAAMY,KAAKpD,OAC9B8B,EAAAjC,QAAAkC,cAAAvC,EAAA6D,WAAWC,UAAU,oBACnBxB,EAAAjC,QAAAkC,cAAAvC,EAAA+D,aAAA,iBACAzB,EAAAjC,QAAAkC,cAAAvC,EAAAgE,aAAaC,KAAK,OAAOC,YAAY,iBAAiBC,SAAU3D,KAAK4D,kBAAkBR,KAAKpD,SAE9F8B,EAAAjC,QAAAkC,cAAAvC,EAAA6D,WAAWC,UAAU,wBACnBxB,EAAAjC,QAAAkC,cAAAvC,EAAA+D,aAAA,iBACAzB,EAAAjC,QAAAkC,cAAAvC,EAAAgE,aAAaC,KAAK,WAAWC,YAAY,iBAAiBC,SAAU3D,KAAK6D,kBAAkBT,KAAKpD,SAElG8B,EAAAjC,QAAAkC,cAAAvC,EAAAsE,YAAA,KACEhC,EAAAjC,QAAAkC,cAAAxC,EAAAwE,eAAelB,GAAA,aAAiBf,EAAAjC,QAAAkC,cAAAvC,EAAAwE,QAAQ/B,QAAQ,WAAhB,sBAChCH,EAAAjC,QAAAkC,cAAAvC,EAAAwE,QAAQ/B,QAAQ,UAAUgC,QAASjE,KAAKkE,oBAAoBd,KAAKpD,OAAjE,mBACA8B,EAAAjC,QAAAkC,cAAAvC,EAAAwE,QAAQP,KAAK,SAASxB,QAAQ,WAA9B,iBAAAkC,EA3EOrE,GA2EPqE,EAAAtE,QA3EOC,EAoFrBA,EAAMsE,cACJC,OAAQC,EAAAzE,QAAU0E","file":"17.index.js","sourcesContent":["import React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Link } from 'react-router-dom';\r\nimport { Redirect } from 'react-router';\r\nimport Request from 'superagent';\r\nimport { LinkContainer } from 'react-router-bootstrap';\r\nimport { FormGroup, ControlLabel, FormControl, ButtonGroup, Button, Panel, Breadcrumb, Well } from 'react-bootstrap';\r\nimport auth from '../utils/auth.js'\r\nimport config from '../utils/config.js';\r\n\r\nexport default class Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    document.title=config.getTitle() + \" | login\";\r\n    this.state = {\r\n      message: null,\r\n      username: '',\r\n      password: ''\r\n    };\r\n  }\r\n\r\n  validateEmail(email) {\r\n    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    return re.test(email);\r\n  }\r\n\r\n  forgotPasswordClick(event) {\r\n    if (!this.state.username) {\r\n      this.setState({message: <Panel bsStyle='danger'>Please fill username and click Forgot password again.</Panel>});\r\n    } else if (!this.validateEmail(this.state.username)) {\r\n      this.setState({message: <Panel bsStyle='danger'>No email address registered on &quot;{this.state.username}&quot;. Contact Jostein (jostein.oygarden@gmail.com) to recover password.</Panel>});\r\n    } else {\r\n      Request.get(config.getUrl(\"users/forgotPassword?username=\" + this.state.username + \"&hostname=\" + window.location.hostname)).withCredentials().end((err, res) => {\r\n        if (err) {\r\n          this.setState({message: <Panel bsStyle='danger'>{err.toString()}</Panel>});\r\n        } else {\r\n          this.setState({message: <Panel bsStyle='success'>An e-mail with instructions to reset your password is sent to &quot;{this.state.username}&quot;.</Panel>});\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  login(event) {\r\n    event.preventDefault();\r\n    auth.login(this.state.username, this.state.password, (loggedIn) => {\r\n      const { location } = this.props\r\n      if (!loggedIn) {\r\n        return this.setState({message: <Panel bsStyle='danger'>Invalid username and/or password.</Panel>});\r\n      } else {\r\n        return this.setState({message: null, pushUrl: \"/\"});\r\n      }\r\n    });\r\n  }\r\n\r\n  onUsernameChanged(e) {\r\n    this.setState({username: e.target.value});\r\n  }\r\n\r\n  onPasswordChanged(e) {\r\n    this.setState({password: e.target.value});\r\n  }\r\n\r\n  render() {\r\n    if (this.state && this.state.pushUrl) {\r\n      return (<Redirect to={this.state.pushUrl} push />);\r\n    }\r\n    return (\r\n      <span>\r\n        <Breadcrumb>\r\n          <Link to={`/`}>Home</Link> / <font color='#777'>Sign in</font>\r\n        </Breadcrumb>\r\n        <Well>\r\n          {this.state.message}\r\n          <form onSubmit={this.login.bind(this)}>\r\n            <FormGroup controlId=\"formControlsText\">\r\n              <ControlLabel>Username</ControlLabel>\r\n              <FormControl type=\"text\" placeholder=\"Enter username\" onChange={this.onUsernameChanged.bind(this)} />\r\n            </FormGroup>\r\n            <FormGroup controlId=\"formControlsPassword\">\r\n              <ControlLabel>Password</ControlLabel>\r\n              <FormControl type=\"password\" placeholder=\"Enter password\" onChange={this.onPasswordChanged.bind(this)} />\r\n            </FormGroup>\r\n            <ButtonGroup>\r\n              <LinkContainer to={`/register`}><Button bsStyle=\"default\">Register new user</Button></LinkContainer>\r\n              <Button bsStyle=\"default\" onClick={this.forgotPasswordClick.bind(this)}>Forgot password</Button>\r\n              <Button type=\"submit\" bsStyle=\"success\">Login</Button>\r\n            </ButtonGroup>\r\n          </form>\r\n        </Well>\r\n      </span>\r\n    );\r\n  }\r\n}\r\n\r\nLogin.contextTypes = {\r\n  router: PropTypes.object\r\n}\r\n"],"sourceRoot":""}